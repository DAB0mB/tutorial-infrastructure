<!DOCTYPE html><html lang="en"><head>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,400italic,600,600italic,700,800,700italic,800italic" rel="stylesheet" type="text/css">
    <title>Angular2-Meteor</title>
    <meta charset="UTF-8">
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
    <base href="/">
    <style>.logo[_ngcontent-uub-1] {
  width: auto;
  height: 2em; }

.main-toolbar[_ngcontent-uub-1] {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  box-shadow: 3px 0 6px rgba(0, 0, 0, 0.3);
  background: #90A4AE; }

.fill-remaining-space[_ngcontent-uub-1] {
  -ms-flex: 1 1 auto;
      flex: 1 1 auto; }</style><style>/*

Original highlight.js style (c) Ivan Sagalaev <maniac@softwaremaniacs.org>

*/
.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  background: #F0F0F0; }

/* Base color: saturation 0; */
.hljs,
.hljs-subst {
  color: #444; }

.hljs-comment {
  color: #888888; }

.hljs-keyword,
.hljs-attribute,
.hljs-selector-tag,
.hljs-meta-keyword,
.hljs-doctag,
.hljs-name {
  font-weight: bold; }

/* User color: hue: 0 */
.hljs-type,
.hljs-string,
.hljs-number,
.hljs-selector-id,
.hljs-selector-class,
.hljs-quote,
.hljs-template-tag,
.hljs-deletion {
  color: #880000; }

.hljs-title,
.hljs-section {
  color: #880000;
  font-weight: bold; }

.hljs-regexp,
.hljs-symbol,
.hljs-variable,
.hljs-template-variable,
.hljs-link,
.hljs-selector-attr,
.hljs-selector-pseudo {
  color: #BC6060; }

/* Language color: hue: 90; */
.hljs-literal {
  color: #78A960; }

.hljs-built_in,
.hljs-bullet,
.hljs-code,
.hljs-addition {
  color: #397300; }

/* Meta color: hue: 200 */
.hljs-meta {
  color: #1f7199; }

.hljs-meta-string {
  color: #4d99bf; }

/* Misc effects */
.hljs-emphasis {
  font-style: italic; }

.hljs-strong {
  font-weight: bold; }

/*

github.com style (c) Vasily Polovnyov <vast@whiteants.net>

*/
.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  color: #333;
  background: #f8f8f8; }

.hljs-comment,
.hljs-quote {
  color: #998;
  font-style: italic; }

.hljs-keyword,
.hljs-selector-tag,
.hljs-subst {
  color: #333;
  font-weight: bold; }

.hljs-number,
.hljs-literal,
.hljs-variable,
.hljs-template-variable,
.hljs-tag .hljs-attr {
  color: #008080; }

.hljs-string,
.hljs-doctag {
  color: #d14; }

.hljs-title,
.hljs-section,
.hljs-selector-id {
  color: #900;
  font-weight: bold; }

.hljs-subst {
  font-weight: normal; }

.hljs-type,
.hljs-class .hljs-title {
  color: #458;
  font-weight: bold; }

.hljs-tag,
.hljs-name,
.hljs-attribute {
  color: #000080;
  font-weight: normal; }

.hljs-regexp,
.hljs-link {
  color: #009926; }

.hljs-symbol,
.hljs-bullet {
  color: #990073; }

.hljs-built_in,
.hljs-builtin-name {
  color: #0086b3; }

.hljs-meta {
  color: #999;
  font-weight: bold; }

.hljs-deletion {
  background: #fdd; }

.hljs-addition {
  background: #dfd; }

.hljs-emphasis {
  font-style: italic; }

.hljs-strong {
  font-weight: bold; }

body {
  padding: 0;
  margin: 0;
  padding-top: 64px;
  font-family: 'Open Sans', sans-serif; }

pre {
  background: transparent;
  border: none;
  white-space: pre-wrap; }

code {
  white-space: pre-wrap; }

.step-item {
  margin: 0;
  padding: 0;
  border-bottom: 1px solid #CFD8DC;
  color: #546E7A; }

.step-link {
  text-decoration: none;
  color: #536E7A;
  display: block;
  font-size: 14px;
  padding: 16px 16px;
  margin: 0;
  background-color: #ECEFF1; }

.active-step a {
  font-weight: bold; }

.tutorial-steps-list {
  list-style: none;
  padding-left: 0;
  margin-top: 8px; }

.md-primary {
  background: #263238 !important;
  color: white !important;
  cursor: pointer !important; }
  .md-primary[disabled] {
    color: lightgray !important;
    cursor: not-allowed !important; }

tutorial-page-content pre code[ngnonbindable] {
  background: #eee;
  display: block;
  width: 90%;
  border-radius: 5px;
  padding: 10px; }

.diffbox {
  border-radius: 10px; }
  .diffbox .title-panel {
    border-radius: 10px 10px 0 0; }
  .diffbox .code-container {
    border-radius: 0 0 10px 10px; }
</style><style>/** * Mixin that creates a new stacking context. * see https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context */ /** * This mixin hides an element visually. * That means it's still accessible for screen-readers but not visible in view. */ /** * Forces an element to grow to fit floated contents; used as as an alternative to * `overflow: hidden;` because it doesn't cut off contents. */ /** * A mixin, which generates temporary ink ripple on a given component. * When $bindToParent is set to true, it will check for the focused class on the same selector as you included * that mixin. * It is also possible to specify the color palette of the temporary ripple. By default it uses the * accent palette for its background. */ md-toolbar { display: -webkit-box; display: -ms-flexbox; display: flex; box-sizing: border-box; width: 100%; min-height: 64px; font-size: 20px; font-weight: 400; font-family: Roboto, "Helvetica Neue", sans-serif; padding: 0 16px; -webkit-box-orient: vertical; -webkit-box-direction: normal; -ms-flex-direction: column; flex-direction: column; background: whitesmoke; color: rgba(0, 0, 0, 0.87); } md-toolbar.md-primary { background: #009688; color: white; } md-toolbar.md-accent { background: #9c27b0; color: rgba(255, 255, 255, 0.870588); } md-toolbar.md-warn { background: #f44336; color: white; } md-toolbar md-toolbar-row { display: -webkit-box; display: -ms-flexbox; display: flex; box-sizing: border-box; width: 100%; height: 64px; -webkit-box-orient: horizontal; -webkit-box-direction: normal; -ms-flex-direction: row; flex-direction: row; -webkit-box-align: center; -ms-flex-align: center; align-items: center; } </style><style>/** * A collection of mixins and CSS classes that can be used to apply elevation to a material * element. * See: https://www.google.com/design/spec/what-is-material/elevation-shadows.html * Examples: * * * .md-foo { *   @include $md-elevation(2); * *   &:active { *     @include $md-elevation(8); *   } * } * * <div id="external-card" class="md-elevation-z2"><p>Some content</p></div> * * For an explanation of the design behind how elevation is implemented, see the design doc at * https://goo.gl/Kq0k9Z. */ /** * The css property used for elevation. In most cases this should not be changed. It is exposed * as a variable for abstraction / easy use when needing to reference the property directly, for * example in a will-change rule. */ /** The default duration value for elevation transitions. */ /** The default easing value for elevation transitions. */ /** * Applies the correct css rules to an element to give it the elevation specified by $zValue. * The $zValue must be between 0 and 24. */ /** * Returns a string that can be used as the value for a transition property for elevation. * Calling this function directly is useful in situations where a component needs to transition * more than one property. * * .foo { *   transition: md-elevation-transition-property-value(), opacity 100ms ease; *   will-change: $md-elevation-property, opacity; * } */ /** * Applies the correct css rules needed to have an element transition between elevations. * This mixin should be applied to elements whose elevation values will change depending on their * context (e.g. when active or disabled). */ /** Applies a property to an md-button element for each of the supported palettes. */ /** Applies a focus style to an md-button element for each of the supported palettes. */ [md-raised-button], [md-fab], [md-mini-fab], [md-button], [md-icon-button] { box-sizing: border-box; position: relative; background: transparent; text-align: center; cursor: pointer; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; outline: none; border: none; display: inline-block; white-space: nowrap; text-decoration: none; vertical-align: baseline; font-size: 14px; font-family: Roboto, "Helvetica Neue", sans-serif; font-weight: 500; color: currentColor; margin: 0; min-width: 88px; line-height: 36px; padding: 0 16px; border-radius: 3px; } .md-primary[md-raised-button], .md-primary[md-fab], .md-primary[md-mini-fab], .md-primary[md-button], .md-primary[md-icon-button] { color: #009688; } .md-accent[md-raised-button], .md-accent[md-fab], .md-accent[md-mini-fab], .md-accent[md-button], .md-accent[md-icon-button] { color: #9c27b0; } .md-warn[md-raised-button], .md-warn[md-fab], .md-warn[md-mini-fab], .md-warn[md-button], .md-warn[md-icon-button] { color: #f44336; } .md-primary[disabled][md-raised-button], .md-primary[disabled][md-fab], .md-primary[disabled][md-mini-fab], .md-primary[disabled][md-button], .md-primary[disabled][md-icon-button], .md-accent[disabled][md-raised-button], .md-accent[disabled][md-fab], .md-accent[disabled][md-mini-fab], .md-accent[disabled][md-button], .md-accent[disabled][md-icon-button], .md-warn[disabled][md-raised-button], .md-warn[disabled][md-fab], .md-warn[disabled][md-mini-fab], .md-warn[disabled][md-button], .md-warn[disabled][md-icon-button], [disabled][disabled][md-raised-button], [disabled][disabled][md-fab], [disabled][disabled][md-mini-fab], [disabled][disabled][md-button], [disabled][disabled][md-icon-button] { color: rgba(0, 0, 0, 0.38); } [disabled][md-raised-button], [disabled][md-fab], [disabled][md-mini-fab], [disabled][md-button], [disabled][md-icon-button] { cursor: default; } .md-button-focus[md-raised-button]::after, .md-button-focus[md-fab]::after, .md-button-focus[md-mini-fab]::after, .md-button-focus[md-button]::after, .md-button-focus[md-icon-button]::after { position: absolute; top: 0; left: 0; bottom: 0; right: 0; content: ''; background-color: rgba(0, 0, 0, 0.12); border-radius: inherit; pointer-events: none; } .md-button-focus.md-primary[md-raised-button]::after, .md-button-focus.md-primary[md-fab]::after, .md-button-focus.md-primary[md-mini-fab]::after, .md-button-focus.md-primary[md-button]::after, .md-button-focus.md-primary[md-icon-button]::after { background-color: rgba(0, 150, 136, 0.12); } .md-button-focus.md-accent[md-raised-button]::after, .md-button-focus.md-accent[md-fab]::after, .md-button-focus.md-accent[md-mini-fab]::after, .md-button-focus.md-accent[md-button]::after, .md-button-focus.md-accent[md-icon-button]::after { background-color: rgba(156, 39, 176, 0.12); } .md-button-focus.md-warn[md-raised-button]::after, .md-button-focus.md-warn[md-fab]::after, .md-button-focus.md-warn[md-mini-fab]::after, .md-button-focus.md-warn[md-button]::after, .md-button-focus.md-warn[md-icon-button]::after { background-color: rgba(244, 67, 54, 0.12); } [md-raised-button], [md-fab], [md-mini-fab] { box-shadow: 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12); background-color: #fafafa; -webkit-transform: translate3d(0, 0, 0); transform: translate3d(0, 0, 0); -webkit-transition: background 400ms cubic-bezier(0.25, 0.8, 0.25, 1), box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1); transition: background 400ms cubic-bezier(0.25, 0.8, 0.25, 1), box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1); } .md-primary[md-raised-button], .md-primary[md-fab], .md-primary[md-mini-fab] { color: white; } .md-accent[md-raised-button], .md-accent[md-fab], .md-accent[md-mini-fab] { color: rgba(255, 255, 255, 0.870588); } .md-warn[md-raised-button], .md-warn[md-fab], .md-warn[md-mini-fab] { color: white; } .md-primary[disabled][md-raised-button], .md-primary[disabled][md-fab], .md-primary[disabled][md-mini-fab], .md-accent[disabled][md-raised-button], .md-accent[disabled][md-fab], .md-accent[disabled][md-mini-fab], .md-warn[disabled][md-raised-button], .md-warn[disabled][md-fab], .md-warn[disabled][md-mini-fab], [disabled][disabled][md-raised-button], [disabled][disabled][md-fab], [disabled][disabled][md-mini-fab] { color: rgba(0, 0, 0, 0.38); } .md-primary[md-raised-button], .md-primary[md-fab], .md-primary[md-mini-fab] { background-color: #009688; } .md-accent[md-raised-button], .md-accent[md-fab], .md-accent[md-mini-fab] { background-color: #9c27b0; } .md-warn[md-raised-button], .md-warn[md-fab], .md-warn[md-mini-fab] { background-color: #f44336; } .md-primary[disabled][md-raised-button], .md-primary[disabled][md-fab], .md-primary[disabled][md-mini-fab], .md-accent[disabled][md-raised-button], .md-accent[disabled][md-fab], .md-accent[disabled][md-mini-fab], .md-warn[disabled][md-raised-button], .md-warn[disabled][md-fab], .md-warn[disabled][md-mini-fab], [disabled][disabled][md-raised-button], [disabled][disabled][md-fab], [disabled][disabled][md-mini-fab] { background-color: rgba(0, 0, 0, 0.12); } [md-raised-button]:active, [md-fab]:active, [md-mini-fab]:active { box-shadow: 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12); } [disabled][md-raised-button], [disabled][md-fab], [disabled][md-mini-fab] { box-shadow: none; } [md-button][disabled]:hover.md-primary, [md-button][disabled]:hover.md-accent, [md-button][disabled]:hover.md-warn, [md-button][disabled]:hover:hover { background-color: transparent; } [md-fab] { min-width: 0; border-radius: 50%; background-color: #9c27b0; color: rgba(255, 255, 255, 0.870588); width: 56px; height: 56px; padding: 0; } [md-fab] i, [md-fab] md-icon { padding: 16px 0; } [md-mini-fab] { min-width: 0; border-radius: 50%; background-color: #9c27b0; color: rgba(255, 255, 255, 0.870588); width: 40px; height: 40px; padding: 0; } [md-mini-fab] i, [md-mini-fab] md-icon { padding: 8px 0; } [md-icon-button] { min-width: 0; padding: 0; width: 40px; height: 40px; line-height: 24px; border-radius: 50%; } [md-icon-button] .md-button-wrapper > * { vertical-align: middle; } [md-button]:hover::after, [md-icon-button]:hover::after { position: absolute; top: 0; left: 0; bottom: 0; right: 0; content: ''; background-color: rgba(0, 0, 0, 0.12); border-radius: inherit; pointer-events: none; } [md-button]:hover.md-primary::after, [md-icon-button]:hover.md-primary::after { background-color: rgba(0, 150, 136, 0.12); } [md-button]:hover.md-accent::after, [md-icon-button]:hover.md-accent::after { background-color: rgba(156, 39, 176, 0.12); } [md-button]:hover.md-warn::after, [md-icon-button]:hover.md-warn::after { background-color: rgba(244, 67, 54, 0.12); } @media screen and (-ms-high-contrast: active) { .md-raised-button, .md-fab, .md-mini-fab { border: 1px solid #fff; } } </style><style>.side-nav[_ngcontent-uub-5] {
  background: #ECEFF1;
  width: 232px;
  bottom: 0;
  overflow: auto;
  z-index: 100;
  border-right: 1px solid rgba(0, 0, 0, 0.3); }
  .side-nav[_ngcontent-uub-5] ul[_ngcontent-uub-5] {
    margin-top: 8px; }

.right-buttons[_ngcontent-uub-5] {
  float: right;
  margin-right: 250px;
  margin-top: 10px; }

.tutorial-title[_ngcontent-uub-5] {
  margin: 15px;
  float: left;
  font-size: larger;
  font-weight: bold; }

.top-navigation[_ngcontent-uub-5] {
  position: fixed;
  margin-top: -60px;
  width: 100%;
  background-color: #ECEFF1;
  height: 60px;
  z-index: 50; }

.tutorial-content[_ngcontent-uub-5] {
  margin-top: 60px;
  padding: 20px; }

.tutorials-container[_ngcontent-uub-5] {
  padding-left: 230px; }

.l-pinned-top[_ngcontent-uub-5] {
  position: fixed;
  top: 0px;
  left: 0px;
  right: 0px; }

.l-pinned-left[_ngcontent-uub-5] {
  position: fixed;
  top: 0px;
  left: 0px;
  bottom: 0px; }

.l-left[_ngcontent-uub-5] {
  float: left; }

.l-right[_ngcontent-uub-5] {
  float: right; }

.l-relative[_ngcontent-uub-5], .docs-content[_ngcontent-uub-5] {
  position: relative; }

.l-absolute[_ngcontent-uub-5] {
  position: absolute; }

.l-fixed[_ngcontent-uub-5] {
  position: fixed; }

.l-offset-side-nav[_ngcontent-uub-5] {
  padding-left: 232px; }

.l-offset-nav[_ngcontent-uub-5] {
  padding-top: 64px; }</style><style>.diffbox[_ngcontent-uub-11] {
  border: 1px solid #eee;
  -webkit-text-size-adjust: 100%;
  margin: 1.5em 0; }
  .diffbox[_ngcontent-uub-11] .title-panel[_ngcontent-uub-11] {
    padding: 5px 12px;
    background: #eee;
    border-bottom: solid 1px #eee;
    color: #333;
    overflow: auto; }
    .diffbox[_ngcontent-uub-11] .title-panel[_ngcontent-uub-11] .github-commit-link[_ngcontent-uub-11] {
      float: right;
      color: black;
      text-decoration: none;
      border-bottom: none !important; }
  .diffbox[_ngcontent-uub-11] .code-container[_ngcontent-uub-11] {
    overflow-x: auto;
    position: relative;
    padding: 9px 3px 3px 0;
    background: #f8f8f8; }
    .diffbox[_ngcontent-uub-11] .code-container[_ngcontent-uub-11] .scroll-container[_ngcontent-uub-11] {
      display: inline-block;
      min-width: 100%;
      overflow: hidden; }
    .diffbox[_ngcontent-uub-11] .code-container[_ngcontent-uub-11] pre[_ngcontent-uub-11] {
      margin: 0;
      padding: 0;
      background-color: transparent; }
      .diffbox[_ngcontent-uub-11] .code-container[_ngcontent-uub-11] pre.line-added[_ngcontent-uub-11] {
        background: #eaffea; }
      .diffbox[_ngcontent-uub-11] .code-container[_ngcontent-uub-11] pre.line-removed[_ngcontent-uub-11] {
        background: #ff9ea2; }
    .diffbox[_ngcontent-uub-11] .code-container[_ngcontent-uub-11] .line-content[_ngcontent-uub-11] {
      padding-left: 36px;
      overflow: hidden; }
      .diffbox[_ngcontent-uub-11] .code-container[_ngcontent-uub-11] .line-content[_ngcontent-uub-11] .hljs-comment[_ngcontent-uub-11] {
        color: #777; }
    .diffbox[_ngcontent-uub-11] .code-container[_ngcontent-uub-11] .line-numbers[_ngcontent-uub-11] {
      text-align: right;
      -moz-user-select: none;
      -khtml-user-select: none;
      -webkit-user-select: none;
      -o-user-select: none;
      position: absolute;
      width: 25px; }
      .diffbox[_ngcontent-uub-11] .code-container[_ngcontent-uub-11] .line-numbers[_ngcontent-uub-11] .line-number[_ngcontent-uub-11] {
        color: #aaa;
        font-style: italic; }</style></head><body><universal-styles></universal-styles>


<app _nghost-uub-1=""><md-toolbar _ngcontent-uub-1="" class="main-toolbar md-primary"><div class="md-toolbar-layout"> <md-toolbar-row> 
    <a _ngcontent-uub-1="" href="/"><img _ngcontent-uub-1="" class="logo" src="/assets/images/logo.png"></a>
    <button _ngcontent-uub-1="" md-button=""><span class="md-button-wrapper">Tutorials</span> </button>
    <button _ngcontent-uub-1="" md-button=""><span class="md-button-wrapper">Angular 2</span> </button>
    <button _ngcontent-uub-1="" md-button=""><span class="md-button-wrapper">Docs</span> </button>
    <span _ngcontent-uub-1="" class="fill-remaining-space"></span>
    <button _ngcontent-uub-1="" md-button=""><span class="md-button-wrapper">Github</span> </button>
    <button _ngcontent-uub-1="" md-button=""><span class="md-button-wrapper">Blog</span> </button>
    <button _ngcontent-uub-1="" md-button=""><span class="md-button-wrapper">Contact Us</span> </button>
    <button _ngcontent-uub-1="" md-button=""><span class="md-button-wrapper">Manifesto</span> </button>
    <button _ngcontent-uub-1="" md-button=""><span class="md-button-wrapper">About us</span> </button>
 </md-toolbar-row>  </div></md-toolbar>
<router-outlet _ngcontent-uub-1=""></router-outlet><tutorial _nghost-uub-5=""><div _ngcontent-uub-5="" class="tutorials-container">
    <nav _ngcontent-uub-5="" class="side-nav l-pinned-left l-layer-4 l-offset-nav">
        <steps-list _ngcontent-uub-5=""><!--template bindings={}--><ul class="tutorial-steps-list">
    <!--template bindings={}--><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/bootstrap">1. Bootstrap</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/static-template">2. Static Templates</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/dynamic-template">3. Dynamic Templates</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/3-way-data-binding">4. 3-way Data Binding</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/adding-removing-objects-and-angular-event-handling">5. Data Management</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/routing-and-multiple-views">6. Routing &amp; Multiple Views</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/bindings">7. Bindings</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/folder-structure">8. Folder Structure</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/users-and-authentication">9. Users &amp; Authentication</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/privacy-and-publish-subscribe-functions">10. Privacy &amp; Subscriptions</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/deploying-your-app">11. Deployment</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/running-your-app-on-android-or-ios-with-phonegap">12. Mobile Support</a>
    </li><li class="step-item active-step" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/search-sort-pagination-and-reactive-vars">13. Filter and Pagination</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/using-and-creating-angularjs-pipes">14. AngularJS Pipes</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/meteor-methods">15. Meteor Methods</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/conditional-template-directives-with-angularjs">16. Conditional Templates</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/google-maps">17. Google Maps</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/css-sass-and-bootstrap">18. CSS, SASS and Bootstrap</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/angular-material-and-custom-angular-auth-forms">19. Angular2-Material &amp; Custom Auth</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/3rd-party-libraries">20. Third-Party Libraries</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/files-and-uploadfs">21. Files and UploadFS</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/packages-isolation">22. Packages Isolation</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/ionic2">23. Ionic2</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/ngupgrade-and-migration">24. ngUpgrade &amp; Migration</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/next-steps">25. Next Steps</a>
    </li>
</ul>
</steps-list>
    </nav>
    <div _ngcontent-uub-5="" class="top-navigation">
        <span _ngcontent-uub-5="" class="tutorial-title" stepName="">Filter and Pagination</span>
        <div _ngcontent-uub-5="" class="right-buttons">
            <a _ngcontent-uub-5="" class="md-primary" md-raised-button="" tutorialNavigation="previous" href="/tutorials/angular2/socially/running-your-app-on-android-or-ios-with-phonegap">Previous</a>
            <a _ngcontent-uub-5="" class="md-primary" codeDiffButton="" md-raised-button="">Code Diff</a>
            <a _ngcontent-uub-5="" class="md-primary" md-raised-button="" tutorialNavigation="next" href="/tutorials/angular2/socially/using-and-creating-angularjs-pipes">Next</a>
        </div>
    </div>
    <div _ngcontent-uub-5="" class="tutorial-content">
        <router-outlet _ngcontent-uub-5=""></router-outlet><tutorial-page><div class="tutorial-container"></div></tutorial-page><tutorial-page-content><p>In this step we are going to add:</p>

<ul><li>parties list pagination</li><li>sorting by party name</li><li>lastly, we will move our previously implemented parties location search to the server side.</li></ul>

<p>Pagination simply means delivering and showing parties to the client on a page-by-page basis,
where each page has a predefined number of items. Pagination reduces the number of documents to be transferred at one time thus decreasing load time. It also increases the usability of the user interface if there are too many documents in the storage.</p>

<p>Besides client-side logic, it usually includes querying a specific page of parties on
the server side to deliver up to the client as well.</p>

<h1>Pagination</h1>

<p>First off, we'll add pagination on the server side.</p>

<p>Thanks to the simplicity of the Mongo API combined with Meteor's power, we only need to execute <code ngNonBindable="">Parties.find</code> on the server with some additional parameters. Keep in mind, with Meteor's isomorphic environment, we'll query <code ngNonBindable="">Parties</code> on the client with the same parameters as on the server.</p>

<h3>Mongo Collection query options</h3>

<p><code ngNonBindable="">Collection.find</code> has a convenient second parameter called <code ngNonBindable="">options</code>,
which takes an object for configuring collection querying.
To implement pagination we'll need to provide <em>sort</em>, <em>limit</em>, and <em>skip</em> fields as <code ngNonBindable="">options</code>.</p>

<p>While  <em>limit</em> and <em>skip</em> set boundaries on the result set, <em>sort</em>, at the same time, may not.
We'll use <em>sort</em> to guarantee consistency of our pagination across page changes and page loads,
since Mongo doesn't guarantee any order of documents if they are queried and not sorted.
You can find more information about the <em>find</em> method in Mongo <a href="http://docs.meteor.com/#/full/find">here</a>.</p>

<p>Now, let's go to the <code ngNonBindable="">parties</code> subscription in the <code ngNonBindable="">server/parties.ts</code> file,
add the <code ngNonBindable="">options</code> parameter to the subscription method, and then pass it to <code ngNonBindable="">Parties.find</code>:</p>

<p><diffbox step="12.1" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.1</span> <span _ngcontent-uub-11="" class="commit-summary">Add options to the parties publication</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/ab37cdaaa6d490a4544bc6d214390ff2077f357f">server/parties.ts</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">21</pre><pre _ngcontent-uub-11="" class="line-number">22</pre><pre _ngcontent-uub-11="" class="line-number">23</pre><pre _ngcontent-uub-11="" class="line-number">24</pre><pre _ngcontent-uub-11="" class="line-number">25</pre><pre _ngcontent-uub-11="" class="line-number">26</pre><pre _ngcontent-uub-11="" class="line-number">27</pre><pre _ngcontent-uub-11="" class="line-number">28</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-keyword">return</span> isAvailable;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">}</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">Meteor.publish(<span class="hljs-string">'parties'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options: <span class="hljs-built_in">Object</span></span>) </span>{</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  <span class="hljs-keyword">return</span> Parties.find(buildQuery.call(<span class="hljs-keyword">this</span>), options);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">});</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">Meteor.publish(<span class="hljs-string">'party'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">partyId: <span class="hljs-built_in">string</span></span>) </span>{</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>On the client side, we are going to define three additional variables in the <code ngNonBindable="">PartiesList</code> component which our pagination will depend on:
page size, current page number and name sort order.
Secondly, we'll create a special <em>options</em> object made up of these variables and pass it to the parties subscription:</p>

<p><diffbox step="12.2" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.2</span> <span _ngcontent-uub-11="" class="commit-summary">Create options and add them to the parties subscription</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/cb892da87f77014bd9624d4bf15c2e0034d04058">client/imports/parties-list/parties-list.ts</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">15</pre><pre _ngcontent-uub-11="" class="line-number">16</pre><pre _ngcontent-uub-11="" class="line-number">17</pre><pre _ngcontent-uub-11="" class="line-number">18</pre><pre _ngcontent-uub-11="" class="line-number">19</pre><pre _ngcontent-uub-11="" class="line-number">20</pre><pre _ngcontent-uub-11="" class="line-number">21</pre><pre _ngcontent-uub-11="" class="line-number">22</pre><pre _ngcontent-uub-11="" class="line-number">23</pre><pre _ngcontent-uub-11="" class="line-number">24</pre><pre _ngcontent-uub-11="" class="line-number">25</pre><pre _ngcontent-uub-11="" class="line-number">26</pre><pre _ngcontent-uub-11="" class="line-number">27</pre><pre _ngcontent-uub-11="" class="line-number">28</pre><pre _ngcontent-uub-11="" class="line-number">29</pre><pre _ngcontent-uub-11="" class="line-number">30</pre><pre _ngcontent-uub-11="" class="line-number">31</pre><pre _ngcontent-uub-11="" class="line-number">32</pre><pre _ngcontent-uub-11="" class="line-number">33</pre><pre _ngcontent-uub-11="" class="line-number">34</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context">})</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> PartiesList extends MeteorComponent{</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  parties: Mongo.Cursor&lt;Party&gt;;</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  pageSize: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  curPage: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  nameOrder: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-keyword">constructor</span>() {</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    <span class="hljs-keyword">super</span>();</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added"> </pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    <span class="hljs-keyword">let</span> options = {</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">      limit: <span class="hljs-keyword">this</span>.pageSize,</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">      skip: (<span class="hljs-keyword">this</span>.curPage - <span class="hljs-number">1</span>) * <span class="hljs-keyword">this</span>.pageSize,</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">      sort: { name: <span class="hljs-keyword">this</span>.nameOrder }</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    };</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added"> </pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    <span class="hljs-keyword">this</span>.subscribe(<span class="hljs-string">'parties'</span>, options, () =&gt; {</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      <span class="hljs-keyword">this</span>.parties = Parties.find();</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    }, <span class="hljs-literal">true</span>);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  }</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>As was said before, we also need to query <code ngNonBindable="">Parties</code> on the client side with same parameters and options as we used on the server, i.e., parameters and options we pass to the server side.</p>

<p>In reality, though, we don't need <em>skip</em> and <em>limit</em> options in this case, since the subscription result of the parties collection will always have a maximum page size of documents on the client.
So, we will only add sorting:</p>

<p><diffbox step="12.3" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.3</span> <span _ngcontent-uub-11="" class="commit-summary">Add sorting by party name to PartiesList</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/a05e8dfbf5923d0c1d40a1193f47ae287b30da39">client/imports/parties-list/parties-list.ts</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">29</pre><pre _ngcontent-uub-11="" class="line-number">30</pre><pre _ngcontent-uub-11="" class="line-number">31</pre><pre _ngcontent-uub-11="" class="line-number">32</pre><pre _ngcontent-uub-11="" class="line-number">33</pre><pre _ngcontent-uub-11="" class="line-number">34</pre><pre _ngcontent-uub-11="" class="line-number">35</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context">    };</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    <span class="hljs-keyword">this</span>.subscribe(<span class="hljs-string">'parties'</span>, options, () =&gt; {</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">      <span class="hljs-keyword">this</span>.parties = Parties.find({}, {sort: { name: <span class="hljs-keyword">this</span>.nameOrder }});</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    }, <span class="hljs-literal">true</span>);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  }</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<h3>Reactive variables</h3>

<p>The last thing that we should do with the logic of pagination is
to make changes of the current variable reactive.</p>

<p>Reactive variables go in a separate Meteor core package. Don't forget to add it:</p>

<pre><code ngNonBindable="">$ meteor add reactive-var</code></pre>

<p>We'll need to re-subscribe with new options each time the page number changes.
Thanks to Meteor, we can easily update subscriptions with the help of Meteor's reactive variables and MeteorComponent's reactive API. Particularly, we are going to use the
<code ngNonBindable="">this.autorun</code> method and make the <code ngNonBindable="">curPage</code> property of the <code ngNonBindable="">PartiesList</code> become reactive:</p>

<p><diffbox step="12.4" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.4</span> <span _ngcontent-uub-11="" class="commit-summary">Re-subscribe on current page changes reactively</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/b4df4c43d8717a3ebcd2482c150d69c1d41b3509">client/imports/parties-list/parties-list.ts</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">16</pre><pre _ngcontent-uub-11="" class="line-number">17</pre><pre _ngcontent-uub-11="" class="line-number">18</pre><pre _ngcontent-uub-11="" class="line-number">19</pre><pre _ngcontent-uub-11="" class="line-number">20</pre><pre _ngcontent-uub-11="" class="line-number">21</pre><pre _ngcontent-uub-11="" class="line-number">22</pre><pre _ngcontent-uub-11="" class="line-number">23</pre><pre _ngcontent-uub-11="" class="line-number">24</pre><pre _ngcontent-uub-11="" class="line-number">25</pre><pre _ngcontent-uub-11="" class="line-number">26</pre><pre _ngcontent-uub-11="" class="line-number">27</pre><pre _ngcontent-uub-11="" class="line-number">28</pre><pre _ngcontent-uub-11="" class="line-number">29</pre><pre _ngcontent-uub-11="" class="line-number">30</pre><pre _ngcontent-uub-11="" class="line-number">31</pre><pre _ngcontent-uub-11="" class="line-number">32</pre><pre _ngcontent-uub-11="" class="line-number">33</pre><pre _ngcontent-uub-11="" class="line-number">34</pre><pre _ngcontent-uub-11="" class="line-number">35</pre><pre _ngcontent-uub-11="" class="line-number">36</pre><pre _ngcontent-uub-11="" class="line-number">37</pre><pre _ngcontent-uub-11="" class="line-number">38</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> PartiesList extends MeteorComponent{</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  parties: Mongo.Cursor&lt;Party&gt;;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  pageSize: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  curPage: ReactiveVar&lt;<span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> ReactiveVar&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-number">1</span>);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  nameOrder: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-keyword">constructor</span>() {</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    <span class="hljs-keyword">super</span>();</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    <span class="hljs-keyword">this</span>.autorun(() =&gt; {</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">      <span class="hljs-keyword">let</span> options = {</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">        limit: <span class="hljs-keyword">this</span>.pageSize,</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">        skip: (<span class="hljs-keyword">this</span>.curPage.get() - <span class="hljs-number">1</span>) * <span class="hljs-keyword">this</span>.pageSize,</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">        sort: { name: <span class="hljs-keyword">this</span>.nameOrder }</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">      };</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">      <span class="hljs-keyword">this</span>.subscribe(<span class="hljs-string">'parties'</span>, options, () =&gt; {</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">        <span class="hljs-keyword">this</span>.parties = Parties.find({}, { sort: { name: <span class="hljs-keyword">this</span>.nameOrder } });</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">      }, <span class="hljs-literal">true</span>);</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    });</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  }</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  removeParty(party) {</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<h1>Pagination UI</h1>

<p>As this paragraph name suggests, the next logical thing to do would be to implement a
pagination UI, which consists of, at least, a list of page links at the bottom of every page,
so that the user can switch pages by clicking on these links.</p>

<p>Creating a pagination component is not a trivial task and not one of the primary goals of this tutorial,
so we are going to make use of an already existing package with Angular 2 pagination components.
Run the following line to add this package:</p>

<pre><code ngNonBindable="">$ meteor npm install angular2-pagination --save</code></pre>

<blockquote><p>This package's pagination mark-up follows the structure of
the <a href="http://getbootstrap.com/components/#pagination">Bootstrap pagination component</a>,
so you can change its look simply by using proper CSS styles.
It's worth noting, though, that this package has been created
with the only this tutorial in mind.
It misses a lot of features that would be quite useful
in the real world, for example, custom templates.
In the future, this package will be replaced by the
pagination <a href="https://github.com/michaelbromley/ng2-pagination">library</a> from the author of the Angular 1 pagination <a href="https://github.com/michaelbromley/angularUtils-pagination/">angularutils:pagination</a> when
the package has matured enough.</p></blockquote>

<p>Ng2-Pagination consists of three main parts:</p>

<ul><li>pagination controls that render a list of links</li><li>a pagination service to manipulate logic programmatically</li><li>a pagination pipe component, which can be added in any component template, with the main goal to
transform a list of items according to the current state of the pagination service and show current page of items on UI</li></ul>

<h3>Angular 2 Pipes</h3>

<p><a href="https://angular.io/docs/ts/latest/guide/pipes.html">Pipes</a> are a new concept introduced in Angular 2, which is essentially similar to Angular 1's filters with some minor differences.
For now, what you need to know is that the pagination pipe will act and look in the template
pretty much the same if we were to use a pagination filter in Angular 1.</p>

<p>First, let's import all of the pagination parts into the <code ngNonBindable="">PartiesList</code> component, and then
set them up to be available in the component's view as follows:</p>

<p><diffbox filename="client/imports/parties-list/parties-list.ts" step="12.8" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.8</span> <span _ngcontent-uub-11="" class="commit-summary">Import and set up pagination components</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/ed266c5b1c593edcd88f12e17272a8fd84f6f40b">client/imports/parties-list/parties-list.ts</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">6</pre><pre _ngcontent-uub-11="" class="line-number">7</pre><pre _ngcontent-uub-11="" class="line-number">8</pre><pre _ngcontent-uub-11="" class="line-number">9</pre><pre _ngcontent-uub-11="" class="line-number">10</pre><pre _ngcontent-uub-11="" class="line-number">11</pre><pre _ngcontent-uub-11="" class="line-number">12</pre><pre _ngcontent-uub-11="" class="line-number">13</pre><pre _ngcontent-uub-11="" class="line-number">14</pre><pre _ngcontent-uub-11="" class="line-number">15</pre><pre _ngcontent-uub-11="" class="line-number">16</pre><pre _ngcontent-uub-11="" class="line-number">17</pre><pre _ngcontent-uub-11="" class="line-number">18</pre><pre _ngcontent-uub-11="" class="line-number">19</pre><pre _ngcontent-uub-11="" class="line-number">20</pre><pre _ngcontent-uub-11="" class="line-number">21</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> { LoginButtons } from <span class="hljs-string">'angular2-meteor-accounts-ui'</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> { MeteorComponent } from <span class="hljs-string">'angular2-meteor'</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> { ReactiveVar } from <span class="hljs-string">'meteor/reactive-var'</span>;</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added"><span class="hljs-keyword">import</span> { PaginationService, PaginatePipe, PaginationControlsCmp } from <span class="hljs-string">'angular2-pagination'</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> template from <span class="hljs-string">'./parties-list.html'</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">@Component({</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  selector: <span class="hljs-string">'parties-list'</span>,</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  viewProviders: [PaginationService],</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  template,</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  directives: [PartiesForm, ROUTER_DIRECTIVES, LoginButtons, PaginationControlsCmp],</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  pipes: [PaginatePipe]</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">})</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> PartiesList extends MeteorComponent{</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  parties: Mongo.Cursor&lt;Party&gt;;</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>And let's also import the stylesheet of the package:</p>

<p><diffbox filename="client/css/main.scss" step="12.8" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.8</span> <span _ngcontent-uub-11="" class="commit-summary">Import and set up pagination components</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/ed266c5b1c593edcd88f12e17272a8fd84f6f40b">client/css/main.scss</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">1</pre><pre _ngcontent-uub-11="" class="line-number">2</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context">@<span class="hljs-keyword">import</span> <span class="hljs-string">"{}/node_modules/angular2-meteor-accounts-ui/build/login-buttons.scss"</span>;</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">@<span class="hljs-keyword">import</span> <span class="hljs-string">"{}/node_modules/angular2-pagination/build/pagination-controls-cmp.scss"</span>;</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>Now, add the pagination pipe and controls to the <code ngNonBindable="">parties-list.html</code> template:</p>

<p><diffbox step="12.9" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.9</span> <span _ngcontent-uub-11="" class="commit-summary">Add pagination markup to the PartiesList's template</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/a1e5cf918c9877b7c3768e4cffa4797805a48f71">client/imports/parties-list/parties-list.html</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">4</pre><pre _ngcontent-uub-11="" class="line-number">5</pre><pre _ngcontent-uub-11="" class="line-number">6</pre><pre _ngcontent-uub-11="" class="line-number">7</pre><pre _ngcontent-uub-11="" class="line-number">8</pre><pre _ngcontent-uub-11="" class="line-number">9</pre><pre _ngcontent-uub-11="" class="line-number">10</pre><pre _ngcontent-uub-11="" class="line-number">11</pre><pre _ngcontent-uub-11="" class="line-number">12</pre><pre _ngcontent-uub-11="" class="line-number">13</pre><pre _ngcontent-uub-11="" class="line-number">14</pre><pre _ngcontent-uub-11="" class="line-number">15</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"search(searchtext.value)"</span>&gt;</span>Search<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;<span class="hljs-name">login-buttons</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">login-buttons</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> *<span class="hljs-attr">ngFor</span>=<span class="hljs-string">"let party of parties | paginate:{currentPage: 1, itemsPerPage: pageSize, totalItems: 30}"</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> [<span class="hljs-attr">routerLink</span>]=<span class="hljs-string">"['/party', party._id]"</span>&gt;</span>{{party.name}}<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{party.description}}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{party.location}}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"removeParty(party)"</span>&gt;</span>X<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  <span class="hljs-tag">&lt;<span class="hljs-name">pagination-controls</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">pagination-controls</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>In the pipe definition, we provided the current page number, the page size and a new value of total items in the list to paginate.</p>

<p>This total number of items are required to be set in our case, since we don't provide a
regular array of elements but instead a Mongo cursor; the pagination pipe simply won't know how to calculate its size.</p>

<p>We'll get back to this in the next paragraph where we'll be setting parties total size reactively.
For now, let's just set it to be 30. We'll see why this default value is needed shortly.</p>

<h3>onChange events</h3>

<p>The final part is to handle user clicks on the page links. The pagination controls component
fires a special event when the user clicks on a page link, causing the current page to update.
Let's handle this event in the template first and then add a method to the <code ngNonBindable="">PartiesList</code> component itself:</p>

<p><diffbox step="12.10" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.10</span> <span _ngcontent-uub-11="" class="commit-summary">Handle page changed event of the pagination controls</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/338edbca916460406abab8742b0f3c9ad7978a1e">client/imports/parties-list/parties-list.html</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">11</pre><pre _ngcontent-uub-11="" class="line-number">12</pre><pre _ngcontent-uub-11="" class="line-number">13</pre><pre _ngcontent-uub-11="" class="line-number">14</pre><pre _ngcontent-uub-11="" class="line-number">15</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"removeParty(party)"</span>&gt;</span>X<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  <span class="hljs-tag">&lt;<span class="hljs-name">pagination-controls</span> (<span class="hljs-attr">change</span>)=<span class="hljs-string">"onPageChanged($event.page)"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">pagination-controls</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>As you can see, the pagination controls component fires the <code ngNonBindable="">onChange</code> event, calling the <code ngNonBindable="">onPageChanged</code> method with
a special event object that contains the new page number to set. Add the <code ngNonBindable="">onPageChanged</code> method:</p>

<p><diffbox step="12.11" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.11</span> <span _ngcontent-uub-11="" class="commit-summary">Add page changed event handler to the component</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/a6d74ba6e22f84e6c1c3475249c4aa379e2fa22f">client/imports/parties-list/parties-list.ts</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">50</pre><pre _ngcontent-uub-11="" class="line-number">51</pre><pre _ngcontent-uub-11="" class="line-number">52</pre><pre _ngcontent-uub-11="" class="line-number">53</pre><pre _ngcontent-uub-11="" class="line-number">54</pre><pre _ngcontent-uub-11="" class="line-number">55</pre><pre _ngcontent-uub-11="" class="line-number">56</pre><pre _ngcontent-uub-11="" class="line-number">57</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context">      <span class="hljs-keyword">this</span>.parties = Parties.find();</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    }</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  }</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added"> </pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  onPageChanged(page: <span class="hljs-built_in">number</span>) {</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    <span class="hljs-keyword">this</span>.curPage.set(page);</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  }</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">}</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>At this moment, we have almost everything in place. Let's check if everything is working.
We are going to have to add a lot of parties, at least, a couple of pages.
But, since we've chosen quite a large default page size (10), it would be tedious to add all parties manually.</p>

<h3>Generating Mock Data</h3>

<p>Thankfully, we have a helpful package called <a href="https://atmospherejs.com/anti/fake"><em>anti:fake</em></a>, which will help us out with the generation of names, locations and other properties of new fake parties.</p>

<pre><code ngNonBindable="">$ meteor add anti:fake</code></pre>

<p>So, with the following lines of code we are going to have 30 parties in total
(given that we already have three):</p>

<p><strong><code ngNonBindable="">server/load_parties.ts</code></strong>:</p>

<pre><code ngNonBindable="">...

for (var i = 0; i &lt; 27; i++) {
  Parties.insert({
    name: Fake.sentence(50),
    location: Fake.sentence(10),
    description: Fake.sentence(100),
    public: true
  });
}</code></pre>

<p>Fake is loaded in Meteor as a global, you may want to declare it for TypeScript.</p>

<p><strong><code ngNonBindable="">typings/party.d.ts</code></strong>:</p>

<pre><code ngNonBindable="">declare var Fake: {
    sentence(words: number): string;
}</code></pre>

<p>Now reset the database (<code ngNonBindable="">meteor reset</code>) and run the app. You should see a list of 10 parties shown initially and 3 pages links just at the bottom.</p>

<p>Play around with the pagination: click on page links to go back and forth,
then try to delete parties to check if the current page updates properly.</p>

<h1>Getting the Total Number of Parties</h1>

<p>The pagination component needs to know how many pages it will create. As such, we need to know the total number of parties in storage and divide it by the number of items per page.</p>

<p>At the same time, our parties collection will always have no more than necessary parties on the client side.
This suggests that we have to add a new publication to publish only the current count of parties existing in storage.</p>

<p>This task looks quite common and, thankfully, it's already been
implemented. We can use the <a href="https://github.com/percolatestudio/publish-counts">tmeasday:publish-counts</a> package.</p>

<pre><code ngNonBindable="">$ meteor add tmeasday:publish-counts</code></pre>

<p>This package is an example for a package that does not provide it's own Typings, so we will have to create <code ngNonBindable="">d.ts</code> file by our self according to the package API:</p>

<p><diffbox filename="typings/publish-counts.d.ts" step="12.12" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.12</span> <span _ngcontent-uub-11="" class="commit-summary">Add counts package and the typings file</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/a97df56f3f769306861fcfe2f051724de97c2a5b">typings/publish-counts.d.ts</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">1</pre><pre _ngcontent-uub-11="" class="line-number">2</pre><pre _ngcontent-uub-11="" class="line-number">3</pre><pre _ngcontent-uub-11="" class="line-number">4</pre><pre _ngcontent-uub-11="" class="line-number">5</pre><pre _ngcontent-uub-11="" class="line-number">6</pre><pre _ngcontent-uub-11="" class="line-number">7</pre><pre _ngcontent-uub-11="" class="line-number">8</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-added" className="line-added"><span class="hljs-keyword">interface</span> CountsObject {</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  <span class="hljs-keyword">get</span>(publicationName : <span class="hljs-built_in">string</span>) : <span class="hljs-built_in">number</span>;</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  publish(context : <span class="hljs-built_in">any</span>, publicationName : <span class="hljs-built_in">string</span>, cursor : Mongo.Cursor, options : <span class="hljs-built_in">any</span>) : <span class="hljs-built_in">number</span>;</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">}</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added"> </pre><pre _ngcontent-uub-11="" class="line-added" className="line-added"><span class="hljs-keyword">declare</span> <span class="hljs-keyword">module</span> "meteor/tmeasday:publish-counts" {</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  <span class="hljs-keyword">export</span> <span class="hljs-keyword">let</span> Counts : CountsObject;</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">}</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>This package exports a <code ngNonBindable="">Counts</code> object with all of the API methods we will need.</p>

<blockquote><p>Notice that you'll see a TypeScript warning in the terminal
saying that "Counts" is not defined, when you start using the API.
You can remove this warning by adding a <a href="https://github.com/correpw/meteor-publish-counts.d.ts/blob/master/Counts.d.ts">publish-counts type declaration file</a> to your typings.</p></blockquote>

<p>Let's publish the total number of parties as follows:</p>

<p><diffbox step="12.13" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.13</span> <span _ngcontent-uub-11="" class="commit-summary">Publish total number of parties</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/76e82e4c1b11db98f9df001cc576e438a7e6a5c3">server/parties.ts</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">1</pre><pre _ngcontent-uub-11="" class="line-number">2</pre><pre _ngcontent-uub-11="" class="line-number">3</pre><pre _ngcontent-uub-11="" class="line-number">4</pre><pre _ngcontent-uub-11="" class="line-number">5</pre><pre _ngcontent-uub-11="" class="line-number">6</pre><pre _ngcontent-uub-11="" class="line-number"> </pre><pre _ngcontent-uub-11="" class="line-number">23</pre><pre _ngcontent-uub-11="" class="line-number">24</pre><pre _ngcontent-uub-11="" class="line-number">25</pre><pre _ngcontent-uub-11="" class="line-number">26</pre><pre _ngcontent-uub-11="" class="line-number">27</pre><pre _ngcontent-uub-11="" class="line-number">28</pre><pre _ngcontent-uub-11="" class="line-number">29</pre><pre _ngcontent-uub-11="" class="line-number">30</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> {Parties} from <span class="hljs-string">'../collections/parties'</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> {Meteor} from <span class="hljs-string">'meteor/meteor'</span>;</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added"><span class="hljs-keyword">import</span> {Counts} from <span class="hljs-string">'meteor/tmeasday:publish-counts'</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildQuery</span>(<span class="hljs-params">partyId?: <span class="hljs-built_in">string</span></span>): <span class="hljs-title">Object</span> </span>{</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-keyword">var</span> isAvailable = {</pre><pre _ngcontent-uub-11="" class="" className=""><span class="hljs-comment">...some lines skipped...</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">}</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">Meteor.publish(<span class="hljs-string">'parties'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options: <span class="hljs-built_in">Object</span></span>) </span>{</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  Counts.publish(<span class="hljs-keyword">this</span>, <span class="hljs-string">'numberOfParties'</span>, Parties.find(buildQuery.call(<span class="hljs-keyword">this</span>)), { noReady: <span class="hljs-literal">true</span> });</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-keyword">return</span> Parties.find(buildQuery.call(<span class="hljs-keyword">this</span>), options);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">});</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<blockquote><p>Notice that we are passing <code ngNonBindable="">{ noReady: true }</code> in the last argument so
that the publication will be ready only after our main cursor is loads.</p></blockquote>

<p>We've just created the new <em>numberOfParties</em> publication.
Let's get it reactively on the client side using the <code ngNonBindable="">Counts</code> object, and, at the same time,
introduce a new <code ngNonBindable="">partiesSize</code> property in the <code ngNonBindable="">PartiesList</code> component:</p>

<p><diffbox step="12.14" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.14</span> <span _ngcontent-uub-11="" class="commit-summary">Handle reactive updates of the parties total number</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/70e52f0dfc5051fa6ed2b4d750329c5a0da14fa6">client/imports/parties-list/parties-list.ts</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">6</pre><pre _ngcontent-uub-11="" class="line-number">7</pre><pre _ngcontent-uub-11="" class="line-number">8</pre><pre _ngcontent-uub-11="" class="line-number">9</pre><pre _ngcontent-uub-11="" class="line-number">10</pre><pre _ngcontent-uub-11="" class="line-number">11</pre><pre _ngcontent-uub-11="" class="line-number">12</pre><pre _ngcontent-uub-11="" class="line-number"> </pre><pre _ngcontent-uub-11="" class="line-number">23</pre><pre _ngcontent-uub-11="" class="line-number">24</pre><pre _ngcontent-uub-11="" class="line-number">25</pre><pre _ngcontent-uub-11="" class="line-number">26</pre><pre _ngcontent-uub-11="" class="line-number">27</pre><pre _ngcontent-uub-11="" class="line-number">28</pre><pre _ngcontent-uub-11="" class="line-number">29</pre><pre _ngcontent-uub-11="" class="line-number"> </pre><pre _ngcontent-uub-11="" class="line-number">39</pre><pre _ngcontent-uub-11="" class="line-number">40</pre><pre _ngcontent-uub-11="" class="line-number">41</pre><pre _ngcontent-uub-11="" class="line-number">42</pre><pre _ngcontent-uub-11="" class="line-number">43</pre><pre _ngcontent-uub-11="" class="line-number">44</pre><pre _ngcontent-uub-11="" class="line-number">45</pre><pre _ngcontent-uub-11="" class="line-number">46</pre><pre _ngcontent-uub-11="" class="line-number">47</pre><pre _ngcontent-uub-11="" class="line-number">48</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> { LoginButtons } from <span class="hljs-string">'angular2-meteor-accounts-ui'</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> { MeteorComponent } from <span class="hljs-string">'angular2-meteor'</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> { ReactiveVar } from <span class="hljs-string">'meteor/reactive-var'</span>;</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added"><span class="hljs-keyword">import</span> { Counts } from <span class="hljs-string">'meteor/tmeasday:publish-counts'</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> { PaginationService, PaginatePipe, PaginationControlsCmp } from <span class="hljs-string">'angular2-pagination'</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> template from <span class="hljs-string">'./parties-list.html'</span>;</pre><pre _ngcontent-uub-11="" class="" className=""><span class="hljs-comment">...some lines skipped...</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  pageSize: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  curPage: ReactiveVar&lt;<span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> ReactiveVar&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-number">1</span>);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  nameOrder: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  partiesSize: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-keyword">constructor</span>() {</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    <span class="hljs-keyword">super</span>();</pre><pre _ngcontent-uub-11="" class="" className=""><span class="hljs-comment">...some lines skipped...</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">        <span class="hljs-keyword">this</span>.parties = Parties.find({}, { sort: { name: <span class="hljs-keyword">this</span>.nameOrder } });</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      }, <span class="hljs-literal">true</span>);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    });</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added"> </pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    <span class="hljs-keyword">this</span>.autorun(() =&gt; {</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">      <span class="hljs-keyword">this</span>.partiesSize = Counts.get(<span class="hljs-string">'numberOfParties'</span>);</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    }, <span class="hljs-literal">true</span>);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  }</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  removeParty(party) {</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>Then, we use this new property in the template to set up pagination properly:</p>

<p><diffbox step="12.15" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.15</span> <span _ngcontent-uub-11="" class="commit-summary">Add parties total number var in the template</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/8c7dc9f163e7eedeae229fc307ea79829103d94f">client/imports/parties-list/parties-list.html</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">4</pre><pre _ngcontent-uub-11="" class="line-number">5</pre><pre _ngcontent-uub-11="" class="line-number">6</pre><pre _ngcontent-uub-11="" class="line-number">7</pre><pre _ngcontent-uub-11="" class="line-number">8</pre><pre _ngcontent-uub-11="" class="line-number">9</pre><pre _ngcontent-uub-11="" class="line-number">10</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"search(searchtext.value)"</span>&gt;</span>Search<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;<span class="hljs-name">login-buttons</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">login-buttons</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> *<span class="hljs-attr">ngFor</span>=<span class="hljs-string">"let party of parties | paginate:{currentPage: 1, itemsPerPage: pageSize, totalItems: partiesSize}"</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> [<span class="hljs-attr">routerLink</span>]=<span class="hljs-string">"['/party', party._id]"</span>&gt;</span>{{party.name}}<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{party.description}}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{party.location}}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>Let's verify that the Socially app works the same as before.
Run the app. There should be same three pages of parties.</p>

<p>What's more interesting is to add a couple of new parties, thus, adding
a new 4th page. By this way, we can prove that our new "total number" publication and pagination controls are all working properly.</p>

<h1>Changing Sort Order</h1>

<p>It's time for a new cool feature Socially users will certainly enjoy - sorting the parties list by party name.
At this moment, we know everything we need to implement it.</p>

<p>As previously implements, <code ngNonBindable="">nameOrder</code> uses one of two values, 1 or -1, to express ascending and descending orders
respectively. Then, as you can see, we assign <code ngNonBindable="">nameOrder</code> to the party property (currently, <code ngNonBindable="">name</code>) we want to sort.</p>

<p>We'll add a new dropdown UI control with two orders to change, ascending and descending. Let's add it in front of our parties list:</p>

<p><diffbox step="12.16" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.16</span> <span _ngcontent-uub-11="" class="commit-summary">Add a sort order dropdown</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/139e32db12d9b4efa30908ce6f8fd182c799426f">client/imports/parties-list/parties-list.html</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">3</pre><pre _ngcontent-uub-11="" class="line-number">4</pre><pre _ngcontent-uub-11="" class="line-number">5</pre><pre _ngcontent-uub-11="" class="line-number">6</pre><pre _ngcontent-uub-11="" class="line-number">7</pre><pre _ngcontent-uub-11="" class="line-number">8</pre><pre _ngcontent-uub-11="" class="line-number">9</pre><pre _ngcontent-uub-11="" class="line-number">10</pre><pre _ngcontent-uub-11="" class="line-number">11</pre><pre _ngcontent-uub-11="" class="line-number">12</pre><pre _ngcontent-uub-11="" class="line-number">13</pre><pre _ngcontent-uub-11="" class="line-number">14</pre><pre _ngcontent-uub-11="" class="line-number">15</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> #<span class="hljs-attr">searchtext</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Search by Location"</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"search(searchtext.value)"</span>&gt;</span>Search<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;<span class="hljs-name">login-buttons</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">login-buttons</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Parties:<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> #<span class="hljs-attr">sort</span> (<span class="hljs-attr">change</span>)=<span class="hljs-string">"changeSortOrder(sort.value)"</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">selected</span>&gt;</span>Ascending<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"-1"</span>&gt;</span>Descending<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> *<span class="hljs-attr">ngFor</span>=<span class="hljs-string">"let party of parties | paginate:{currentPage: 1, itemsPerPage: pageSize, totalItems: partiesSize}"</span>&gt;</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> [<span class="hljs-attr">routerLink</span>]=<span class="hljs-string">"['/party', party._id]"</span>&gt;</span>{{party.name}}<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>In the <code ngNonBindable="">PartiesList</code> component, we change the <code ngNonBindable="">nameOrder</code> property to be a reactive variable and add a <code ngNonBindable="">changeSortOrder</code> event handler, where we set the new sort order:</p>

<p><diffbox step="12.17" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.17</span> <span _ngcontent-uub-11="" class="commit-summary">Re-subscribe reactively when sort order changes</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/3931d60f8c3c0784378e7170333701d87298783c">client/imports/parties-list/parties-list.ts</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">22</pre><pre _ngcontent-uub-11="" class="line-number">23</pre><pre _ngcontent-uub-11="" class="line-number">24</pre><pre _ngcontent-uub-11="" class="line-number">25</pre><pre _ngcontent-uub-11="" class="line-number">26</pre><pre _ngcontent-uub-11="" class="line-number">27</pre><pre _ngcontent-uub-11="" class="line-number">28</pre><pre _ngcontent-uub-11="" class="line-number"> </pre><pre _ngcontent-uub-11="" class="line-number">32</pre><pre _ngcontent-uub-11="" class="line-number">33</pre><pre _ngcontent-uub-11="" class="line-number">34</pre><pre _ngcontent-uub-11="" class="line-number">35</pre><pre _ngcontent-uub-11="" class="line-number">36</pre><pre _ngcontent-uub-11="" class="line-number">37</pre><pre _ngcontent-uub-11="" class="line-number">38</pre><pre _ngcontent-uub-11="" class="line-number">39</pre><pre _ngcontent-uub-11="" class="line-number">40</pre><pre _ngcontent-uub-11="" class="line-number">41</pre><pre _ngcontent-uub-11="" class="line-number">42</pre><pre _ngcontent-uub-11="" class="line-number"> </pre><pre _ngcontent-uub-11="" class="line-number">57</pre><pre _ngcontent-uub-11="" class="line-number">58</pre><pre _ngcontent-uub-11="" class="line-number">59</pre><pre _ngcontent-uub-11="" class="line-number">60</pre><pre _ngcontent-uub-11="" class="line-number">61</pre><pre _ngcontent-uub-11="" class="line-number">62</pre><pre _ngcontent-uub-11="" class="line-number">63</pre><pre _ngcontent-uub-11="" class="line-number">64</pre><pre _ngcontent-uub-11="" class="line-number">65</pre><pre _ngcontent-uub-11="" class="line-number">66</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context">  parties: Mongo.Cursor&lt;Party&gt;;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  pageSize: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  curPage: ReactiveVar&lt;<span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> ReactiveVar&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-number">1</span>);</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  nameOrder: ReactiveVar&lt;<span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> ReactiveVar&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-number">1</span>);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  partiesSize: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-keyword">constructor</span>() {</pre><pre _ngcontent-uub-11="" class="" className=""><span class="hljs-comment">...some lines skipped...</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      <span class="hljs-keyword">let</span> options = {</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">        limit: <span class="hljs-keyword">this</span>.pageSize,</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">        skip: (<span class="hljs-keyword">this</span>.curPage.get() - <span class="hljs-number">1</span>) * <span class="hljs-keyword">this</span>.pageSize,</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">        sort: { name: <span class="hljs-keyword">this</span>.nameOrder.get() }</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      };</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      <span class="hljs-keyword">this</span>.subscribe(<span class="hljs-string">'parties'</span>, options, () =&gt; {</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">        <span class="hljs-keyword">this</span>.parties = Parties.find({}, { sort: { name: <span class="hljs-keyword">this</span>.nameOrder.get() } });</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      }, <span class="hljs-literal">true</span>);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    });</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="" className=""><span class="hljs-comment">...some lines skipped...</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    }</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  }</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  changeSortOrder(nameOrder: <span class="hljs-built_in">string</span>) {</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    <span class="hljs-keyword">this</span>.nameOrder.set(<span class="hljs-built_in">parseInt</span>(nameOrder));</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  }</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  onPageChanged(page: <span class="hljs-built_in">number</span>) {</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    <span class="hljs-keyword">this</span>.curPage.set(page);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  }</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>That's just it! Run the app and change the sort order back and forth.
What's important here is that pagination updates properly, i.e. according to a new sort order.</p>

<h1>Server Side Search</h1>

<p>Before this step we had a nice feature to search parties by location, but with the addition of pagination, location search has partly broken. In its current state, there will always be no more than the current page of parties shown simultaneously on the client side. We would like, of course, to search parties across all storage, not just across the current page.</p>

<p>To fix that, we'll need to patch our "parties" and "total number" publications on the server side
to query parties with a new "location" parameter passed down from the client.
Having that fixed, it should work properly in accordance with the added pagination.</p>

<p>So, let's add filtering parties by the location with the help of Mongo's regex API.
It is going to look like this:</p>

<p><diffbox step="12.18" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.18</span> <span _ngcontent-uub-11="" class="commit-summary">Add search by the party location using Mongo regex</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/a6ffebadae6086a81c51f7b03a2bf38efd83505d">server/parties.ts</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">2</pre><pre _ngcontent-uub-11="" class="line-number">3</pre><pre _ngcontent-uub-11="" class="line-number">4</pre><pre _ngcontent-uub-11="" class="line-number">5</pre><pre _ngcontent-uub-11="" class="line-number">6</pre><pre _ngcontent-uub-11="" class="line-number">7</pre><pre _ngcontent-uub-11="" class="line-number">8</pre><pre _ngcontent-uub-11="" class="line-number">9</pre><pre _ngcontent-uub-11="" class="line-number">10</pre><pre _ngcontent-uub-11="" class="line-number">11</pre><pre _ngcontent-uub-11="" class="line-number"> </pre><pre _ngcontent-uub-11="" class="line-number">19</pre><pre _ngcontent-uub-11="" class="line-number">20</pre><pre _ngcontent-uub-11="" class="line-number">21</pre><pre _ngcontent-uub-11="" class="line-number">22</pre><pre _ngcontent-uub-11="" class="line-number">23</pre><pre _ngcontent-uub-11="" class="line-number">24</pre><pre _ngcontent-uub-11="" class="line-number">25</pre><pre _ngcontent-uub-11="" class="line-number">26</pre><pre _ngcontent-uub-11="" class="line-number">27</pre><pre _ngcontent-uub-11="" class="line-number">28</pre><pre _ngcontent-uub-11="" class="line-number">29</pre><pre _ngcontent-uub-11="" class="line-number">30</pre><pre _ngcontent-uub-11="" class="line-number">31</pre><pre _ngcontent-uub-11="" class="line-number">32</pre><pre _ngcontent-uub-11="" class="line-number">33</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> {Meteor} from <span class="hljs-string">'meteor/meteor'</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> {Counts} from <span class="hljs-string">'meteor/tmeasday:publish-counts'</span>;</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-added" className="line-added"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildQuery</span>(<span class="hljs-params">partyId: <span class="hljs-built_in">string</span>, location: <span class="hljs-built_in">string</span></span>): <span class="hljs-title">Object</span> </span>{</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-keyword">var</span> isAvailable = {</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    $or: [</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">      { <span class="hljs-keyword">public</span>: <span class="hljs-literal">true</span> },</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      {</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">        $and: [</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">          { owner: <span class="hljs-keyword">this</span>.userId },</pre><pre _ngcontent-uub-11="" class="" className=""><span class="hljs-comment">...some lines skipped...</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    <span class="hljs-keyword">return</span> { $and: [{ _id: partyId }, isAvailable] };</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  }</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  <span class="hljs-keyword">let</span> searchRegEx = { <span class="hljs-string">'$regex'</span>: <span class="hljs-string">'.*'</span> + (location || <span class="hljs-string">''</span>) + <span class="hljs-string">'.*'</span>, <span class="hljs-string">'$options'</span>: <span class="hljs-string">'i'</span> };</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  <span class="hljs-keyword">return</span> { $and: [{ location: searchRegEx }, isAvailable] };</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">}</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">Meteor.publish(<span class="hljs-string">'parties'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options: <span class="hljs-built_in">Object</span>, location: <span class="hljs-built_in">string</span></span>) </span>{</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  Counts.publish(<span class="hljs-keyword">this</span>, <span class="hljs-string">'numberOfParties'</span>,</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    Parties.find(buildQuery.call(<span class="hljs-keyword">this</span>, <span class="hljs-literal">null</span>, location)), { noReady: <span class="hljs-literal">true</span> });</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  <span class="hljs-keyword">return</span> Parties.find(buildQuery.call(<span class="hljs-keyword">this</span>, <span class="hljs-literal">null</span>, location), options);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">});</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">Meteor.publish(<span class="hljs-string">'party'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">partyId: <span class="hljs-built_in">string</span></span>) </span>{</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>On the client side, we are going to add a new reactive variable and set it to update when a user clicks on the search button:</p>

<p><diffbox step="12.19" tutorial="angular2-meteor-socially" _nghost-uub-11=""><div _ngcontent-uub-11="" class="diffbox">
    <div _ngcontent-uub-11="" class="title-panel">
        <span _ngcontent-uub-11="" class="step-number">12.19</span> <span _ngcontent-uub-11="" class="commit-summary">Add reactive search by the location on the client</span>
        <a _ngcontent-uub-11="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/0bb8a2067cd4c673b7b5eeec07db7046a8eb164d">client/imports/parties-list/parties-list.ts</a>
    </div>
    <div _ngcontent-uub-11="" class="code-container">
        <div _ngcontent-uub-11="" class="scroll-container">
            <div _ngcontent-uub-11="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-number">24</pre><pre _ngcontent-uub-11="" class="line-number">25</pre><pre _ngcontent-uub-11="" class="line-number">26</pre><pre _ngcontent-uub-11="" class="line-number">27</pre><pre _ngcontent-uub-11="" class="line-number">28</pre><pre _ngcontent-uub-11="" class="line-number">29</pre><pre _ngcontent-uub-11="" class="line-number">30</pre><pre _ngcontent-uub-11="" class="line-number"> </pre><pre _ngcontent-uub-11="" class="line-number">36</pre><pre _ngcontent-uub-11="" class="line-number">37</pre><pre _ngcontent-uub-11="" class="line-number">38</pre><pre _ngcontent-uub-11="" class="line-number">39</pre><pre _ngcontent-uub-11="" class="line-number">40</pre><pre _ngcontent-uub-11="" class="line-number">41</pre><pre _ngcontent-uub-11="" class="line-number">42</pre><pre _ngcontent-uub-11="" class="line-number"> </pre><pre _ngcontent-uub-11="" class="line-number">51</pre><pre _ngcontent-uub-11="" class="line-number">52</pre><pre _ngcontent-uub-11="" class="line-number">53</pre><pre _ngcontent-uub-11="" class="line-number">54</pre><pre _ngcontent-uub-11="" class="line-number">55</pre><pre _ngcontent-uub-11="" class="line-number">56</pre><pre _ngcontent-uub-11="" class="line-number">57</pre><pre _ngcontent-uub-11="" class="line-number">58</pre>
            </div>
            <div _ngcontent-uub-11="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-uub-11="" class="line-context" className="line-context">  curPage: ReactiveVar&lt;<span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> ReactiveVar&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-number">1</span>);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  nameOrder: ReactiveVar&lt;<span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> ReactiveVar&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-number">1</span>);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  partiesSize: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">  location: ReactiveVar&lt;<span class="hljs-built_in">string</span>&gt; = <span class="hljs-keyword">new</span> ReactiveVar&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-literal">null</span>);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  <span class="hljs-keyword">constructor</span>() {</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    <span class="hljs-keyword">super</span>();</pre><pre _ngcontent-uub-11="" class="" className=""><span class="hljs-comment">...some lines skipped...</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">        sort: { name: <span class="hljs-keyword">this</span>.nameOrder.get() }</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      };</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">      <span class="hljs-keyword">this</span>.subscribe(<span class="hljs-string">'parties'</span>, options, <span class="hljs-keyword">this</span>.location.get(), () =&gt; {</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">        <span class="hljs-keyword">this</span>.parties = Parties.find({}, { sort: { name: <span class="hljs-keyword">this</span>.nameOrder.get() } });</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">      }, <span class="hljs-literal">true</span>);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">    });</pre><pre _ngcontent-uub-11="" class="" className=""><span class="hljs-comment">...some lines skipped...</span></pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  }</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  search(value: <span class="hljs-built_in">string</span>) {</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    <span class="hljs-keyword">this</span>.curPage.set(<span class="hljs-number">1</span>);</pre><pre _ngcontent-uub-11="" class="line-added" className="line-added">    <span class="hljs-keyword">this</span>.location.set(value);</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  }</pre><pre _ngcontent-uub-11="" class="line-context" className="line-context"> </pre><pre _ngcontent-uub-11="" class="line-context" className="line-context">  changeSortOrder(nameOrder: <span class="hljs-built_in">string</span>) {</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<blockquote><p>Notice that we don't know what size to expect from the search
that's why we are re-setting the current page to 1.</p></blockquote>

<p>Let's check it out now that everything works properly altogether: pagination, search, sorting,
removing and addition of new parties.</p>

<p>For example, you can try to add 30 parties in a way mentioned slightly above;
then try to remove all 30 parties; then sort by the descending order; then try to search by Palo Alto — it should
find only two, in case if you have not added any other parties rather than used in this tutorial so far;
then try to remove one of the found parties and, finally, search with an empty location.</p>

<p>Although this sequence of actions looks quite complicated, it was accomplished with rather few lines of code.</p>

<h1>Challenge</h1>

<p>As you could see in the last code difference,
sometimes we have to update reactive variables in a row,
which means that overuse of the reactive variables might lead to multiple re-subscriptions
that we don't need, and in general tangles internal logic of the component.</p>

<p>This step's challenge will be to re-implement new features without reactive variables usage.</p>

<blockquote><p>Hint: you'll need to move the subscribing logic to a separate method
with appropriate parameters and execute it whenever you need to re-subscribe.
Be careful with subscriptions — you'll need
to stop previous subscription each time in order to preserve data consistency on the client.</p></blockquote>

<h1>Summary</h1>

<p>This step covered a lot. We looked at:</p>

<ul><li>Mongo query sort options: <code ngNonBindable="">sort</code>, <code ngNonBindable="">limit</code>, <code ngNonBindable="">skip</code></li><li><code ngNonBindable="">reactive-var</code> for updating variables automatically</li><li>Angular 2 pipes to filter data</li><li>handling onChange events in Angular 2</li><li>generating fake data with <code ngNonBindable="">anti:fake</code></li><li>establishing the total number of results with <code ngNonBindable="">tmeasday:publish-counts</code></li><li>enabling server-side searching across an entire collection</li></ul>

<p>In the <a href="/tutorials/angular2/using-and-creating-angularjs-filters">next step</a> we'll look at sending out our party invitations and look deeper into pipes.</p></tutorial-page-content>
    </div>
</div></tutorial></app>


</body></html>