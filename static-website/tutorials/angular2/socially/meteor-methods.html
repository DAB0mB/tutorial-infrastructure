<!DOCTYPE html><html lang="en"><head>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,400italic,600,600italic,700,800,700italic,800italic" rel="stylesheet" type="text/css">
    <title>Angular2-Meteor</title>
    <meta charset="UTF-8">
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
    <base href="/">
    <style>.logo[_ngcontent-gok-1] {
  width: auto;
  height: 2em; }

.main-toolbar[_ngcontent-gok-1] {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  box-shadow: 3px 0 6px rgba(0, 0, 0, 0.3);
  background: #90A4AE; }
  .main-toolbar[_ngcontent-gok-1] a[_ngcontent-gok-1] {
    color: white;
    text-decoration: none; }

.fill-remaining-space[_ngcontent-gok-1] {
  -ms-flex: 1 1 auto;
      flex: 1 1 auto; }

.tutorials-dropdown[_ngcontent-gok-1] {
  position: relative;
  display: inline-block; }
  .tutorials-dropdown[_ngcontent-gok-1] .dropdown-content[_ngcontent-gok-1] {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 500px;
    box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2);
    border-radius: 5px;
    padding: 7px; }

.tutorials-dropdown[_ngcontent-gok-1]:hover .dropdown-content[_ngcontent-gok-1] {
  display: block; }</style><style>/*

Original highlight.js style (c) Ivan Sagalaev <maniac@softwaremaniacs.org>

*/
.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  background: #F0F0F0; }

/* Base color: saturation 0; */
.hljs,
.hljs-subst {
  color: #444; }

.hljs-comment {
  color: #888888; }

.hljs-keyword,
.hljs-attribute,
.hljs-selector-tag,
.hljs-meta-keyword,
.hljs-doctag,
.hljs-name {
  font-weight: bold; }

/* User color: hue: 0 */
.hljs-type,
.hljs-string,
.hljs-number,
.hljs-selector-id,
.hljs-selector-class,
.hljs-quote,
.hljs-template-tag,
.hljs-deletion {
  color: #880000; }

.hljs-title,
.hljs-section {
  color: #880000;
  font-weight: bold; }

.hljs-regexp,
.hljs-symbol,
.hljs-variable,
.hljs-template-variable,
.hljs-link,
.hljs-selector-attr,
.hljs-selector-pseudo {
  color: #BC6060; }

/* Language color: hue: 90; */
.hljs-literal {
  color: #78A960; }

.hljs-built_in,
.hljs-bullet,
.hljs-code,
.hljs-addition {
  color: #397300; }

/* Meta color: hue: 200 */
.hljs-meta {
  color: #1f7199; }

.hljs-meta-string {
  color: #4d99bf; }

/* Misc effects */
.hljs-emphasis {
  font-style: italic; }

.hljs-strong {
  font-weight: bold; }

/*

github.com style (c) Vasily Polovnyov <vast@whiteants.net>

*/
.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  color: #333;
  background: #f8f8f8; }

.hljs-comment,
.hljs-quote {
  color: #998;
  font-style: italic; }

.hljs-keyword,
.hljs-selector-tag,
.hljs-subst {
  color: #333;
  font-weight: bold; }

.hljs-number,
.hljs-literal,
.hljs-variable,
.hljs-template-variable,
.hljs-tag .hljs-attr {
  color: #008080; }

.hljs-string,
.hljs-doctag {
  color: #d14; }

.hljs-title,
.hljs-section,
.hljs-selector-id {
  color: #900;
  font-weight: bold; }

.hljs-subst {
  font-weight: normal; }

.hljs-type,
.hljs-class .hljs-title {
  color: #458;
  font-weight: bold; }

.hljs-tag,
.hljs-name,
.hljs-attribute {
  color: #000080;
  font-weight: normal; }

.hljs-regexp,
.hljs-link {
  color: #009926; }

.hljs-symbol,
.hljs-bullet {
  color: #990073; }

.hljs-built_in,
.hljs-builtin-name {
  color: #0086b3; }

.hljs-meta {
  color: #999;
  font-weight: bold; }

.hljs-deletion {
  background: #fdd; }

.hljs-addition {
  background: #dfd; }

.hljs-emphasis {
  font-style: italic; }

.hljs-strong {
  font-weight: bold; }

a {
  color: black; }

body {
  padding: 0;
  margin: 0;
  padding-top: 64px;
  font-family: 'Open Sans', sans-serif; }

pre {
  background: transparent;
  border: none;
  white-space: pre-wrap; }

code {
  white-space: pre-wrap; }

.side-nav .step-item {
  margin: 0;
  padding: 0;
  border-bottom: 1px solid #CFD8DC;
  color: #546E7A; }

.side-nav .step-link {
  text-decoration: none;
  color: #536E7A;
  display: block;
  font-size: 14px;
  padding: 16px 16px;
  margin: 0;
  background-color: #ECEFF1; }

.side-nav .active-step a {
  font-weight: bold; }

.side-nav .tutorial-steps-list {
  list-style: none;
  padding-left: 0;
  margin-top: 8px; }

.dropdown-content {
  column-count: 2;
  column-width: 220px;
  column-rule: 1px solid #ECEFF1;
  column-gap: 0; }
  .dropdown-content .tutorial-steps-list {
    margin: 0 !important;
    list-style: none;
    padding: 0; }
    .dropdown-content .tutorial-steps-list .step-item {
      padding: 5px 0 5px 10px;
      border-bottom: 1px solid #ECEFF1;
      break-inside: avoid-column; }
      .dropdown-content .tutorial-steps-list .step-item a {
        text-decoration: none;
        font-size: small;
        color: black; }
      .dropdown-content .tutorial-steps-list .step-item .bold {
        font-weight: bold; }

.md-primary {
  background: #263238 !important;
  color: white !important;
  cursor: pointer !important; }
  .md-primary[disabled] {
    color: lightgray !important;
    cursor: not-allowed !important; }

tutorial-page-content pre code[ngnonbindable] {
  background: #eee;
  display: block;
  width: 90%;
  border-radius: 5px;
  padding: 10px; }

tutorial-page-content blockquote {
  margin: 0;
  position: relative;
  background: #eee;
  border-radius: 5px; }
  tutorial-page-content blockquote:before {
    content: '!';
    font-weight: bold;
    position: absolute;
    vertical-align: top;
    font-size: 2vw;
    color: white;
    margin-left: 6px; }
  tutorial-page-content blockquote p {
    border-left: 1px solid white;
    padding: 10px;
    margin-left: 20px; }

.diffbox {
  border-radius: 10px; }
  .diffbox .title-panel {
    border-radius: 10px 10px 0 0; }
  .diffbox .code-container {
    border-radius: 0 0 10px 10px; }
</style><style>/** * Mixin that creates a new stacking context. * see https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context */ /** * This mixin hides an element visually. * That means it's still accessible for screen-readers but not visible in view. */ /** * Forces an element to grow to fit floated contents; used as as an alternative to * `overflow: hidden;` because it doesn't cut off contents. */ /** * A mixin, which generates temporary ink ripple on a given component. * When $bindToParent is set to true, it will check for the focused class on the same selector as you included * that mixin. * It is also possible to specify the color palette of the temporary ripple. By default it uses the * accent palette for its background. */ md-toolbar { display: -webkit-box; display: -ms-flexbox; display: flex; box-sizing: border-box; width: 100%; min-height: 64px; font-size: 20px; font-weight: 400; font-family: Roboto, "Helvetica Neue", sans-serif; padding: 0 16px; -webkit-box-orient: vertical; -webkit-box-direction: normal; -ms-flex-direction: column; flex-direction: column; background: whitesmoke; color: rgba(0, 0, 0, 0.87); } md-toolbar.md-primary { background: #009688; color: white; } md-toolbar.md-accent { background: #9c27b0; color: rgba(255, 255, 255, 0.870588); } md-toolbar.md-warn { background: #f44336; color: white; } md-toolbar md-toolbar-row { display: -webkit-box; display: -ms-flexbox; display: flex; box-sizing: border-box; width: 100%; height: 64px; -webkit-box-orient: horizontal; -webkit-box-direction: normal; -ms-flex-direction: row; flex-direction: row; -webkit-box-align: center; -ms-flex-align: center; align-items: center; } </style><style>/** * A collection of mixins and CSS classes that can be used to apply elevation to a material * element. * See: https://www.google.com/design/spec/what-is-material/elevation-shadows.html * Examples: * * * .md-foo { *   @include $md-elevation(2); * *   &:active { *     @include $md-elevation(8); *   } * } * * <div id="external-card" class="md-elevation-z2"><p>Some content</p></div> * * For an explanation of the design behind how elevation is implemented, see the design doc at * https://goo.gl/Kq0k9Z. */ /** * The css property used for elevation. In most cases this should not be changed. It is exposed * as a variable for abstraction / easy use when needing to reference the property directly, for * example in a will-change rule. */ /** The default duration value for elevation transitions. */ /** The default easing value for elevation transitions. */ /** * Applies the correct css rules to an element to give it the elevation specified by $zValue. * The $zValue must be between 0 and 24. */ /** * Returns a string that can be used as the value for a transition property for elevation. * Calling this function directly is useful in situations where a component needs to transition * more than one property. * * .foo { *   transition: md-elevation-transition-property-value(), opacity 100ms ease; *   will-change: $md-elevation-property, opacity; * } */ /** * Applies the correct css rules needed to have an element transition between elevations. * This mixin should be applied to elements whose elevation values will change depending on their * context (e.g. when active or disabled). */ /** Applies a property to an md-button element for each of the supported palettes. */ /** Applies a focus style to an md-button element for each of the supported palettes. */ [md-raised-button], [md-fab], [md-mini-fab], [md-button], [md-icon-button] { box-sizing: border-box; position: relative; background: transparent; text-align: center; cursor: pointer; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; outline: none; border: none; display: inline-block; white-space: nowrap; text-decoration: none; vertical-align: baseline; font-size: 14px; font-family: Roboto, "Helvetica Neue", sans-serif; font-weight: 500; color: currentColor; margin: 0; min-width: 88px; line-height: 36px; padding: 0 16px; border-radius: 3px; } .md-primary[md-raised-button], .md-primary[md-fab], .md-primary[md-mini-fab], .md-primary[md-button], .md-primary[md-icon-button] { color: #009688; } .md-accent[md-raised-button], .md-accent[md-fab], .md-accent[md-mini-fab], .md-accent[md-button], .md-accent[md-icon-button] { color: #9c27b0; } .md-warn[md-raised-button], .md-warn[md-fab], .md-warn[md-mini-fab], .md-warn[md-button], .md-warn[md-icon-button] { color: #f44336; } .md-primary[disabled][md-raised-button], .md-primary[disabled][md-fab], .md-primary[disabled][md-mini-fab], .md-primary[disabled][md-button], .md-primary[disabled][md-icon-button], .md-accent[disabled][md-raised-button], .md-accent[disabled][md-fab], .md-accent[disabled][md-mini-fab], .md-accent[disabled][md-button], .md-accent[disabled][md-icon-button], .md-warn[disabled][md-raised-button], .md-warn[disabled][md-fab], .md-warn[disabled][md-mini-fab], .md-warn[disabled][md-button], .md-warn[disabled][md-icon-button], [disabled][disabled][md-raised-button], [disabled][disabled][md-fab], [disabled][disabled][md-mini-fab], [disabled][disabled][md-button], [disabled][disabled][md-icon-button] { color: rgba(0, 0, 0, 0.38); } [disabled][md-raised-button], [disabled][md-fab], [disabled][md-mini-fab], [disabled][md-button], [disabled][md-icon-button] { cursor: default; } .md-button-focus[md-raised-button]::after, .md-button-focus[md-fab]::after, .md-button-focus[md-mini-fab]::after, .md-button-focus[md-button]::after, .md-button-focus[md-icon-button]::after { position: absolute; top: 0; left: 0; bottom: 0; right: 0; content: ''; background-color: rgba(0, 0, 0, 0.12); border-radius: inherit; pointer-events: none; } .md-button-focus.md-primary[md-raised-button]::after, .md-button-focus.md-primary[md-fab]::after, .md-button-focus.md-primary[md-mini-fab]::after, .md-button-focus.md-primary[md-button]::after, .md-button-focus.md-primary[md-icon-button]::after { background-color: rgba(0, 150, 136, 0.12); } .md-button-focus.md-accent[md-raised-button]::after, .md-button-focus.md-accent[md-fab]::after, .md-button-focus.md-accent[md-mini-fab]::after, .md-button-focus.md-accent[md-button]::after, .md-button-focus.md-accent[md-icon-button]::after { background-color: rgba(156, 39, 176, 0.12); } .md-button-focus.md-warn[md-raised-button]::after, .md-button-focus.md-warn[md-fab]::after, .md-button-focus.md-warn[md-mini-fab]::after, .md-button-focus.md-warn[md-button]::after, .md-button-focus.md-warn[md-icon-button]::after { background-color: rgba(244, 67, 54, 0.12); } [md-raised-button], [md-fab], [md-mini-fab] { box-shadow: 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12); background-color: #fafafa; -webkit-transform: translate3d(0, 0, 0); transform: translate3d(0, 0, 0); -webkit-transition: background 400ms cubic-bezier(0.25, 0.8, 0.25, 1), box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1); transition: background 400ms cubic-bezier(0.25, 0.8, 0.25, 1), box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1); } .md-primary[md-raised-button], .md-primary[md-fab], .md-primary[md-mini-fab] { color: white; } .md-accent[md-raised-button], .md-accent[md-fab], .md-accent[md-mini-fab] { color: rgba(255, 255, 255, 0.870588); } .md-warn[md-raised-button], .md-warn[md-fab], .md-warn[md-mini-fab] { color: white; } .md-primary[disabled][md-raised-button], .md-primary[disabled][md-fab], .md-primary[disabled][md-mini-fab], .md-accent[disabled][md-raised-button], .md-accent[disabled][md-fab], .md-accent[disabled][md-mini-fab], .md-warn[disabled][md-raised-button], .md-warn[disabled][md-fab], .md-warn[disabled][md-mini-fab], [disabled][disabled][md-raised-button], [disabled][disabled][md-fab], [disabled][disabled][md-mini-fab] { color: rgba(0, 0, 0, 0.38); } .md-primary[md-raised-button], .md-primary[md-fab], .md-primary[md-mini-fab] { background-color: #009688; } .md-accent[md-raised-button], .md-accent[md-fab], .md-accent[md-mini-fab] { background-color: #9c27b0; } .md-warn[md-raised-button], .md-warn[md-fab], .md-warn[md-mini-fab] { background-color: #f44336; } .md-primary[disabled][md-raised-button], .md-primary[disabled][md-fab], .md-primary[disabled][md-mini-fab], .md-accent[disabled][md-raised-button], .md-accent[disabled][md-fab], .md-accent[disabled][md-mini-fab], .md-warn[disabled][md-raised-button], .md-warn[disabled][md-fab], .md-warn[disabled][md-mini-fab], [disabled][disabled][md-raised-button], [disabled][disabled][md-fab], [disabled][disabled][md-mini-fab] { background-color: rgba(0, 0, 0, 0.12); } [md-raised-button]:active, [md-fab]:active, [md-mini-fab]:active { box-shadow: 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12); } [disabled][md-raised-button], [disabled][md-fab], [disabled][md-mini-fab] { box-shadow: none; } [md-button][disabled]:hover.md-primary, [md-button][disabled]:hover.md-accent, [md-button][disabled]:hover.md-warn, [md-button][disabled]:hover:hover { background-color: transparent; } [md-fab] { min-width: 0; border-radius: 50%; background-color: #9c27b0; color: rgba(255, 255, 255, 0.870588); width: 56px; height: 56px; padding: 0; } [md-fab] i, [md-fab] md-icon { padding: 16px 0; } [md-mini-fab] { min-width: 0; border-radius: 50%; background-color: #9c27b0; color: rgba(255, 255, 255, 0.870588); width: 40px; height: 40px; padding: 0; } [md-mini-fab] i, [md-mini-fab] md-icon { padding: 8px 0; } [md-icon-button] { min-width: 0; padding: 0; width: 40px; height: 40px; line-height: 24px; border-radius: 50%; } [md-icon-button] .md-button-wrapper > * { vertical-align: middle; } [md-button]:hover::after, [md-icon-button]:hover::after { position: absolute; top: 0; left: 0; bottom: 0; right: 0; content: ''; background-color: rgba(0, 0, 0, 0.12); border-radius: inherit; pointer-events: none; } [md-button]:hover.md-primary::after, [md-icon-button]:hover.md-primary::after { background-color: rgba(0, 150, 136, 0.12); } [md-button]:hover.md-accent::after, [md-icon-button]:hover.md-accent::after { background-color: rgba(156, 39, 176, 0.12); } [md-button]:hover.md-warn::after, [md-icon-button]:hover.md-warn::after { background-color: rgba(244, 67, 54, 0.12); } @media screen and (-ms-high-contrast: active) { .md-raised-button, .md-fab, .md-mini-fab { border: 1px solid #fff; } } </style><style>.side-nav[_ngcontent-gok-6] {
  background: #ECEFF1;
  width: 232px;
  bottom: 0;
  overflow: auto;
  z-index: 100;
  border-right: 1px solid rgba(0, 0, 0, 0.3); }
  .side-nav[_ngcontent-gok-6] ul[_ngcontent-gok-6] {
    margin-top: 8px; }

tutorials-versions[_ngcontent-gok-6] {
  margin-left: 10px;
  margin-top: 10px;
  display: block; }

.right-buttons[_ngcontent-gok-6] {
  float: right;
  margin-right: 250px;
  margin-top: 10px; }

.tutorial-title[_ngcontent-gok-6] {
  margin: 15px;
  float: left;
  font-size: larger;
  font-weight: bold; }

.top-navigation[_ngcontent-gok-6] {
  position: fixed;
  margin-top: -60px;
  width: 100%;
  background-color: #ECEFF1;
  height: 60px;
  z-index: 50; }

.tutorial-content[_ngcontent-gok-6] {
  margin-top: 60px;
  padding: 20px; }

.tutorials-container[_ngcontent-gok-6] {
  padding-left: 230px; }

.l-pinned-top[_ngcontent-gok-6] {
  position: fixed;
  top: 0px;
  left: 0px;
  right: 0px; }

.l-pinned-left[_ngcontent-gok-6] {
  position: fixed;
  top: 0px;
  left: 0px;
  bottom: 0px; }

.l-left[_ngcontent-gok-6] {
  float: left; }

.l-right[_ngcontent-gok-6] {
  float: right; }

.l-relative[_ngcontent-gok-6], .docs-content[_ngcontent-gok-6] {
  position: relative; }

.l-absolute[_ngcontent-gok-6] {
  position: absolute; }

.l-fixed[_ngcontent-gok-6] {
  position: fixed; }

.l-offset-side-nav[_ngcontent-gok-6] {
  padding-left: 232px; }

.l-offset-nav[_ngcontent-gok-6] {
  padding-top: 64px; }</style><style>.tutorial-version[_ngcontent-gok-7] {
            margin-left: 10px;
        }
        
        .active[_ngcontent-gok-7] {
            color: #b3e5fc !important;
        }</style><style>.diffbox[_ngcontent-gok-12] {
  border: 1px solid #eee;
  -webkit-text-size-adjust: 100%;
  margin: 1.5em 0; }
  .diffbox[_ngcontent-gok-12] .title-panel[_ngcontent-gok-12] {
    padding: 5px 12px;
    background: #eee;
    border-bottom: solid 1px #eee;
    color: #333;
    overflow: auto; }
    .diffbox[_ngcontent-gok-12] .title-panel[_ngcontent-gok-12] .github-commit-link[_ngcontent-gok-12] {
      float: right;
      color: black;
      text-decoration: none;
      border-bottom: none !important; }
  .diffbox[_ngcontent-gok-12] .code-container[_ngcontent-gok-12] {
    overflow-x: auto;
    position: relative;
    padding: 9px 3px 3px 0;
    background: #f8f8f8; }
    .diffbox[_ngcontent-gok-12] .code-container[_ngcontent-gok-12] .scroll-container[_ngcontent-gok-12] {
      display: inline-block;
      min-width: 100%;
      overflow: hidden; }
    .diffbox[_ngcontent-gok-12] .code-container[_ngcontent-gok-12] pre[_ngcontent-gok-12] {
      margin: 0;
      padding: 0;
      background-color: transparent; }
      .diffbox[_ngcontent-gok-12] .code-container[_ngcontent-gok-12] pre.line-added[_ngcontent-gok-12] {
        background: #eaffea; }
      .diffbox[_ngcontent-gok-12] .code-container[_ngcontent-gok-12] pre.line-removed[_ngcontent-gok-12] {
        background: #ff9ea2; }
    .diffbox[_ngcontent-gok-12] .code-container[_ngcontent-gok-12] .line-content[_ngcontent-gok-12] {
      padding-left: 36px;
      overflow: hidden; }
      .diffbox[_ngcontent-gok-12] .code-container[_ngcontent-gok-12] .line-content[_ngcontent-gok-12] .hljs-comment[_ngcontent-gok-12] {
        color: #777; }
    .diffbox[_ngcontent-gok-12] .code-container[_ngcontent-gok-12] .line-numbers[_ngcontent-gok-12] {
      text-align: right;
      -moz-user-select: none;
      -khtml-user-select: none;
      -webkit-user-select: none;
      -o-user-select: none;
      position: absolute;
      width: 25px; }
      .diffbox[_ngcontent-gok-12] .code-container[_ngcontent-gok-12] .line-numbers[_ngcontent-gok-12] .line-number[_ngcontent-gok-12] {
        color: #aaa;
        font-style: italic; }</style></head><body><universal-styles></universal-styles>


<app _nghost-gok-1=""><md-toolbar _ngcontent-gok-1="" class="main-toolbar md-primary"><div class="md-toolbar-layout"> <md-toolbar-row> 
    <a _ngcontent-gok-1="" href="/"><img _ngcontent-gok-1="" class="logo" src="/assets/images/logo.png"></a>
    <div _ngcontent-gok-1="" class="tutorials-dropdown">
        <button _ngcontent-gok-1="" md-button=""><span class="md-button-wrapper">Tutorials</span> </button>
        <div _ngcontent-gok-1="" class="dropdown-content">
            <steps-list _ngcontent-gok-1="" prefix="/tutorials"><!--template bindings={}--><ul class="tutorial-steps-list">
    <!--template bindings={}--><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/bootstrap">1. Bootstrap</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/static-template">2. Static Templates</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/dynamic-template">3. Dynamic Templates</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/3-way-data-binding">4. 3-way Data Binding</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/adding-removing-objects-and-angular-event-handling">5. Data Management</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/routing-and-multiple-views">6. Routing &amp; Multiple Views</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/bindings">7. Bindings</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/folder-structure">8. Folder Structure</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/users-and-authentication">9. Users &amp; Authentication</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/privacy-and-publish-subscribe-functions">10. Privacy &amp; Subscriptions</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/deploying-your-app">11. Deployment</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/running-your-app-on-android-or-ios-with-phonegap">12. Mobile Support</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/search-sort-pagination-and-reactive-vars">13. Filter and Pagination</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/using-and-creating-angularjs-pipes">14. AngularJS Pipes</a>
    </li><li class="step-item active-step" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/meteor-methods">15. Meteor Methods</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/conditional-template-directives-with-angularjs">16. Conditional Templates</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/google-maps">17. Google Maps</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/css-sass-and-bootstrap">18. CSS, SASS and Bootstrap</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/angular-material-and-custom-angular-auth-forms">19. Angular2-Material &amp; Custom Auth</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/3rd-party-libraries">20. Third-Party Libraries</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/files-and-uploadfs">21. Files and UploadFS</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/packages-isolation">22. Packages Isolation</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/ionic2">23. Ionic2</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/ngupgrade-and-migration">24. ngUpgrade &amp; Migration</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/next-steps">25. Next Steps</a>
    </li>
    <!--template bindings={}--><li class="step-item extra-item">
        <a class="step-link extra-link bold" className="step-link extra-link bold" href="/tutorials/whatsapp2">WhatsApp clone with Angular &amp; Meteor</a>
    </li><li class="step-item extra-item">
        <a class="step-link extra-link bold" className="step-link extra-link bold" href="/tutorials/migration/angular2/introduction">Blaze to Angular 2 Migration tutorial</a>
    </li>
</ul>
</steps-list>
        </div>
    </div>
    <a _ngcontent-gok-1="" href="/angular2/"><button _ngcontent-gok-1="" md-button=""><span class="md-button-wrapper">Angular 2</span> </button></a>
    <a _ngcontent-gok-1="" href="/api/angular2/latest/"><button _ngcontent-gok-1="" md-button=""><span class="md-button-wrapper">API Reference</span> </button></a>
    <span _ngcontent-gok-1="" class="fill-remaining-space"></span>
    <a _ngcontent-gok-1="" href="https://github.com/Urigo/angular2-meteor" target="_blank"><button _ngcontent-gok-1="" md-button=""><span class="md-button-wrapper">GitHub</span> </button></a>
    <a _ngcontent-gok-1="" href="http://info.meteor.com/blog/author/uri-goldshtein?__hstc=219992390.b4a81f3b906b078dac633307097097f5.1471207723059.1471890076881.1471938647239.7&amp;__hssc=219992390.3.1471938647239&amp;__hsfp=714783454" target="_blank"><button _ngcontent-gok-1="" md-button=""><span class="md-button-wrapper">Blog</span> </button></a>
    <a _ngcontent-gok-1="" href="https://docs.google.com/forms/d/e/1FAIpQLSed3JZ0EAcSzkX8Y-iEtvNQRfjeyP2ICQvYMs00ewdmKaplwA/viewform" target="_blank"><button _ngcontent-gok-1="" md-button=""><span class="md-button-wrapper">Contact Us</span> </button></a>
    <a _ngcontent-gok-1="" href="/manifesto"><button _ngcontent-gok-1="" md-button=""><span class="md-button-wrapper">Manifesto</span> </button></a>
    <a _ngcontent-gok-1="" href="/about"><button _ngcontent-gok-1="" md-button=""><span class="md-button-wrapper">About us</span> </button></a>
 </md-toolbar-row>  </div></md-toolbar>
<router-outlet _ngcontent-gok-1=""></router-outlet><tutorial _nghost-gok-6=""><div _ngcontent-gok-6="" class="tutorials-container">
    <nav _ngcontent-gok-6="" class="side-nav l-pinned-left l-layer-4 l-offset-nav">
        <tutorials-versions _ngcontent-gok-6="" _nghost-gok-7=""><!--template bindings={}--><a _ngcontent-gok-7="" md-raised-button="" class="tutorial-version md-primary " className="tutorial-version md-primary " href="/tutorials/angular1/socially/meteor-methods">Angular 1</a><a _ngcontent-gok-7="" md-raised-button="" class="tutorial-version md-primary active" className="tutorial-version md-primary active" href="/tutorials/angular2/socially/meteor-methods">Angular 2</a></tutorials-versions>
        <steps-list _ngcontent-gok-6=""><!--template bindings={}--><ul class="tutorial-steps-list">
    <!--template bindings={}--><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/bootstrap">1. Bootstrap</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/static-template">2. Static Templates</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/dynamic-template">3. Dynamic Templates</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/3-way-data-binding">4. 3-way Data Binding</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/adding-removing-objects-and-angular-event-handling">5. Data Management</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/routing-and-multiple-views">6. Routing &amp; Multiple Views</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/bindings">7. Bindings</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/folder-structure">8. Folder Structure</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/users-and-authentication">9. Users &amp; Authentication</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/privacy-and-publish-subscribe-functions">10. Privacy &amp; Subscriptions</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/deploying-your-app">11. Deployment</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/running-your-app-on-android-or-ios-with-phonegap">12. Mobile Support</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/search-sort-pagination-and-reactive-vars">13. Filter and Pagination</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/using-and-creating-angularjs-pipes">14. AngularJS Pipes</a>
    </li><li class="step-item active-step" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/meteor-methods">15. Meteor Methods</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/conditional-template-directives-with-angularjs">16. Conditional Templates</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/google-maps">17. Google Maps</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/css-sass-and-bootstrap">18. CSS, SASS and Bootstrap</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/angular-material-and-custom-angular-auth-forms">19. Angular2-Material &amp; Custom Auth</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/3rd-party-libraries">20. Third-Party Libraries</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/files-and-uploadfs">21. Files and UploadFS</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/packages-isolation">22. Packages Isolation</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/ionic2">23. Ionic2</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/ngupgrade-and-migration">24. ngUpgrade &amp; Migration</a>
    </li><li class="step-item" routerLinkActive="active-step">
        <a class="step-link" href="/tutorials/angular2/socially/next-steps">25. Next Steps</a>
    </li>
    <!--template bindings={}-->
</ul>
</steps-list>
    </nav>
    <div _ngcontent-gok-6="" class="top-navigation">
        <span _ngcontent-gok-6="" class="tutorial-title" stepName="">Meteor Methods</span>
        <div _ngcontent-gok-6="" class="right-buttons">
            <a _ngcontent-gok-6="" class="md-primary" md-raised-button="" tutorialNavigation="previous" href="/tutorials/angular2/socially/using-and-creating-angularjs-pipes">Previous</a>
            <a _ngcontent-gok-6="" class="md-primary" codeDiffButton="" md-raised-button="">Code Diff</a>
            <a _ngcontent-gok-6="" class="md-primary" md-raised-button="" tutorialNavigation="next" href="/tutorials/angular2/socially/conditional-template-directives-with-angularjs">Next</a>
        </div>
    </div>
    <div _ngcontent-gok-6="" class="tutorial-content">
        <router-outlet _ngcontent-gok-6=""></router-outlet><tutorial-page><div class="tutorial-container"></div></tutorial-page><tutorial-page-content><p>In this step we will learn how to use Meteor Methods to
implement server side logic of the party invitation feature.</p>

<blockquote><p>A capital "M" will be used with Meteor "M"ethods to avoid confusion with Javascript function methods</p></blockquote>

<p>Meteor Methods are a more secure and reliable way to
implement complex logic on the server side in comparison to the direct
manipulations of Mongo collections. Also, we'll touch briefly on
Meteor's UI latency compensation mechanism that comes with these Methods.
This is one of the great Meteor concepts that allows for rapid UI changes.</p>

<h1>Invitation Method</h1>

<p>Let's create a new file <code ngNonBindable="">collections/methods.ts</code>, and add the following <code ngNonBindable="">invite</code> Meteor Method:</p>

<p><diffbox step="14.0" tutorial="angular2-meteor-socially" _nghost-gok-12=""><div _ngcontent-gok-12="" class="diffbox">
    <div _ngcontent-gok-12="" class="title-panel">
        <span _ngcontent-gok-12="" class="step-number">14.0</span> <span _ngcontent-gok-12="" class="commit-summary">Add a party invitation method</span>
        <a _ngcontent-gok-12="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/139d494cfeb9dfd690e029e884c7b13ef8cbc598">collections/methods.ts</a>
    </div>
    <div _ngcontent-gok-12="" class="code-container">
        <div _ngcontent-gok-12="" class="scroll-container">
            <div _ngcontent-gok-12="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-number">1</pre><pre _ngcontent-gok-12="" class="line-number">2</pre><pre _ngcontent-gok-12="" class="line-number">3</pre><pre _ngcontent-gok-12="" class="line-number">4</pre><pre _ngcontent-gok-12="" class="line-number">5</pre><pre _ngcontent-gok-12="" class="line-number">6</pre><pre _ngcontent-gok-12="" class="line-number">7</pre><pre _ngcontent-gok-12="" class="line-number">8</pre><pre _ngcontent-gok-12="" class="line-number">9</pre><pre _ngcontent-gok-12="" class="line-number">10</pre><pre _ngcontent-gok-12="" class="line-number">11</pre><pre _ngcontent-gok-12="" class="line-number">12</pre><pre _ngcontent-gok-12="" class="line-number">13</pre><pre _ngcontent-gok-12="" class="line-number">14</pre><pre _ngcontent-gok-12="" class="line-number">15</pre><pre _ngcontent-gok-12="" class="line-number">16</pre><pre _ngcontent-gok-12="" class="line-number">17</pre><pre _ngcontent-gok-12="" class="line-number">18</pre><pre _ngcontent-gok-12="" class="line-number">19</pre><pre _ngcontent-gok-12="" class="line-number">20</pre><pre _ngcontent-gok-12="" class="line-number">21</pre><pre _ngcontent-gok-12="" class="line-number">22</pre><pre _ngcontent-gok-12="" class="line-number">23</pre><pre _ngcontent-gok-12="" class="line-number">24</pre><pre _ngcontent-gok-12="" class="line-number">25</pre><pre _ngcontent-gok-12="" class="line-number">26</pre><pre _ngcontent-gok-12="" class="line-number">27</pre><pre _ngcontent-gok-12="" class="line-number">28</pre><pre _ngcontent-gok-12="" class="line-number">29</pre><pre _ngcontent-gok-12="" class="line-number">30</pre><pre _ngcontent-gok-12="" class="line-number">31</pre><pre _ngcontent-gok-12="" class="line-number">32</pre><pre _ngcontent-gok-12="" class="line-number">33</pre><pre _ngcontent-gok-12="" class="line-number">34</pre><pre _ngcontent-gok-12="" class="line-number">35</pre><pre _ngcontent-gok-12="" class="line-number">36</pre><pre _ngcontent-gok-12="" class="line-number">37</pre><pre _ngcontent-gok-12="" class="line-number">38</pre><pre _ngcontent-gok-12="" class="line-number">39</pre><pre _ngcontent-gok-12="" class="line-number">40</pre><pre _ngcontent-gok-12="" class="line-number">41</pre><pre _ngcontent-gok-12="" class="line-number">42</pre><pre _ngcontent-gok-12="" class="line-number">43</pre><pre _ngcontent-gok-12="" class="line-number">44</pre><pre _ngcontent-gok-12="" class="line-number">45</pre><pre _ngcontent-gok-12="" class="line-number">46</pre><pre _ngcontent-gok-12="" class="line-number">47</pre>
            </div>
            <div _ngcontent-gok-12="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-added" className="line-added"><span class="hljs-keyword">import</span> {Parties} from <span class="hljs-string">'./parties.ts'</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"><span class="hljs-keyword">import</span> {Email} from <span class="hljs-string">'meteor/email'</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"><span class="hljs-keyword">import</span> {check} from <span class="hljs-string">'meteor/check'</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"><span class="hljs-keyword">import</span> {Meteor} from <span class="hljs-string">'meteor/meteor'</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getContactEmail</span>(<span class="hljs-params">user:Meteor.User</span>):<span class="hljs-title">string</span> </span>{</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  <span class="hljs-keyword">if</span> (user.emails &amp;&amp; user.emails.length)</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">return</span> user.emails[<span class="hljs-number">0</span>].address;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">}</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">Meteor.methods({</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  invite: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">partyId:<span class="hljs-built_in">string</span>, userId:<span class="hljs-built_in">string</span></span>) </span>{</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    check(partyId, <span class="hljs-built_in">String</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    check(userId, <span class="hljs-built_in">String</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">let</span> party = Parties.findOne(partyId);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">if</span> (!party)</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Meteor.Error(<span class="hljs-string">'404'</span>, <span class="hljs-string">'No such party!'</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">if</span> (party.public)</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Meteor.Error(<span class="hljs-string">'400'</span>, <span class="hljs-string">'That party is public. No need to invite people.'</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">if</span> (party.owner !== <span class="hljs-keyword">this</span>.userId)</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Meteor.Error(<span class="hljs-string">'403'</span>, <span class="hljs-string">'No permissions!'</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">if</span> (userId !== party.owner &amp;&amp; (party.invited || []).indexOf(userId) == <span class="hljs-number">-1</span>) {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      Parties.update(partyId, {$addToSet: {invited: userId}});</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">let</span> from = getContactEmail(Meteor.users.findOne(<span class="hljs-keyword">this</span>.userId));</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">let</span> to = getContactEmail(Meteor.users.findOne(userId));</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">if</span> (Meteor.isServer &amp;&amp; to) {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        Email.send({</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">          from: <span class="hljs-string">'noreply@socially.com'</span>,</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">          to: to,</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">          replyTo: from || <span class="hljs-literal">undefined</span>,</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">          subject: <span class="hljs-string">'PARTY: '</span> + party.name,</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">          text: <span class="hljs-string">`Hi, I just invited you to <span class="hljs-subst">${party.name}</span> on Socially.</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">                        \n\nCome check it out: ${Meteor.absoluteUrl()}\n<span class="hljs-string">`</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        });</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">});</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>We used a special API method <code ngNonBindable="">Meteor.methods</code> to register
a new Meteor Method. Again, don't forget to import your created <code ngNonBindable="">methods.ts</code> module
in the server's <code ngNonBindable="">main.ts</code> module to have the Methods defined properly:</p>

<p><diffbox step="14.2" tutorial="angular2-meteor-socially" _nghost-gok-12=""><div _ngcontent-gok-12="" class="diffbox">
    <div _ngcontent-gok-12="" class="title-panel">
        <span _ngcontent-gok-12="" class="step-number">14.2</span> <span _ngcontent-gok-12="" class="commit-summary">Import methods on the server side</span>
        <a _ngcontent-gok-12="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/477418dd1cedb106c637009d18825fe8ae599f0c">server/main.ts</a>
    </div>
    <div _ngcontent-gok-12="" class="code-container">
        <div _ngcontent-gok-12="" class="scroll-container">
            <div _ngcontent-gok-12="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-number">2</pre><pre _ngcontent-gok-12="" class="line-number">3</pre><pre _ngcontent-gok-12="" class="line-number">4</pre><pre _ngcontent-gok-12="" class="line-number">5</pre><pre _ngcontent-gok-12="" class="line-number">6</pre><pre _ngcontent-gok-12="" class="line-number">7</pre>
            </div>
            <div _ngcontent-gok-12="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> {Meteor} from <span class="hljs-string">'meteor/meteor'</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> <span class="hljs-string">'./parties.ts'</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> <span class="hljs-string">'./users.ts'</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"><span class="hljs-keyword">import</span> <span class="hljs-string">'../collections/methods.ts'</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"> </pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">Meteor.startup(loadParties);</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<h3>Latency Compensation</h3>

<p>UI Latency compensation is one of the features that makes Meteor stand out amongst most other Web frameworks, thanks again to the isomorphic environment and Meteor Methods.
In short, visual changes are applied immediately as a response to some user action,
even before the server responds to anything. If you want to read up more about how the view can securely be updated
even before the server is contacted proceed to an <a href="https://meteorhacks.com/introduction-to-latency-compensation">Introduction to Latency Compensation</a> written by Arunoda.</p>

<p>But to make it happen, we need to define our Methods on the client side as well. Let's import our Methods in <code ngNonBindable="">client/app.ts</code>:</p>

<p><diffbox step="14.3" tutorial="angular2-meteor-socially" _nghost-gok-12=""><div _ngcontent-gok-12="" class="diffbox">
    <div _ngcontent-gok-12="" class="title-panel">
        <span _ngcontent-gok-12="" class="step-number">14.3</span> <span _ngcontent-gok-12="" class="commit-summary">Import methods on the client</span>
        <a _ngcontent-gok-12="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/0d9c01bdcf3327f0a305c4c1480fc073f5d69c9a">client/app.ts</a>
    </div>
    <div _ngcontent-gok-12="" class="code-container">
        <div _ngcontent-gok-12="" class="scroll-container">
            <div _ngcontent-gok-12="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-number">5</pre><pre _ngcontent-gok-12="" class="line-number">6</pre><pre _ngcontent-gok-12="" class="line-number">7</pre><pre _ngcontent-gok-12="" class="line-number">8</pre><pre _ngcontent-gok-12="" class="line-number">9</pre><pre _ngcontent-gok-12="" class="line-number">10</pre><pre _ngcontent-gok-12="" class="line-number">11</pre>
            </div>
            <div _ngcontent-gok-12="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> { APP_BASE_HREF } from <span class="hljs-string">'@angular/common'</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> { PartiesList } from <span class="hljs-string">'./imports/parties-list/parties-list.ts'</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> { PartyDetails } from <span class="hljs-string">'./imports/party-details/party-details.ts'</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"><span class="hljs-keyword">import</span> <span class="hljs-string">'../collections/methods.ts'</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"> </pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> template from <span class="hljs-string">'./app.html'</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"> </pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<h3>Validating Methods with Check</h3>

<p>As you can see, we've also done a lot of checks to verify that
all arguments passed down to the method are valid.</p>

<p>First the validity of the arguments' types are checked, and then
the business logic associated with them is checked.</p>

<p>Type validation checks, which are essential for the JavaScript methods dealing with the storage's data,
are done with the help of a handy Meteor's package called <a href="https://atmospherejs.com/meteor/check">"check"</a>.</p>

<pre><code ngNonBindable="">meteor add check</code></pre>

<p>Then, if everything is valid, we send an invitation email.
Here we are using another handy Meteor's package titled <a href="https://atmospherejs.com/meteor/email">"email"</a>.</p>

<pre><code ngNonBindable="">meteor add email</code></pre>

<p>At this point, we are ready to add a call to the new Method from the client.</p>

<p>Let's add a new button right after each username or email in that
list of users to invite in the <code ngNonBindable="">PartyDetails</code>'s template:</p>

<p><diffbox step="14.4" tutorial="angular2-meteor-socially" _nghost-gok-12=""><div _ngcontent-gok-12="" class="diffbox">
    <div _ngcontent-gok-12="" class="title-panel">
        <span _ngcontent-gok-12="" class="step-number">14.4</span> <span _ngcontent-gok-12="" class="commit-summary">Add "invite" button</span>
        <a _ngcontent-gok-12="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/3b7cd5facf4b4ff2572874b2dbe244267ef893aa">client/imports/party-details/party-details.html</a>
    </div>
    <div _ngcontent-gok-12="" class="code-container">
        <div _ngcontent-gok-12="" class="scroll-container">
            <div _ngcontent-gok-12="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-number">16</pre><pre _ngcontent-gok-12="" class="line-number">17</pre><pre _ngcontent-gok-12="" class="line-number">18</pre><pre _ngcontent-gok-12="" class="line-number">19</pre><pre _ngcontent-gok-12="" class="line-number">20</pre><pre _ngcontent-gok-12="" class="line-number">21</pre>
            </div>
            <div _ngcontent-gok-12="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-context" className="line-context">  Users to invite:</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> *<span class="hljs-attr">ngFor</span>=<span class="hljs-string">"let user of users"</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{{ user | displayName }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"invite(user)"</span>&gt;</span>Invite<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>And then, change the component to handle the click event and invite a user:</p>

<p><diffbox step="14.5" tutorial="angular2-meteor-socially" _nghost-gok-12=""><div _ngcontent-gok-12="" class="diffbox">
    <div _ngcontent-gok-12="" class="title-panel">
        <span _ngcontent-gok-12="" class="step-number">14.5</span> <span _ngcontent-gok-12="" class="commit-summary">Add the click handler and call "invite" method</span>
        <a _ngcontent-gok-12="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/c8374d030d6749eda22558203e831a5d639df89d">client/imports/party-details/party-details.ts</a>
    </div>
    <div _ngcontent-gok-12="" class="code-container">
        <div _ngcontent-gok-12="" class="scroll-container">
            <div _ngcontent-gok-12="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-number">52</pre><pre _ngcontent-gok-12="" class="line-number">53</pre><pre _ngcontent-gok-12="" class="line-number">54</pre><pre _ngcontent-gok-12="" class="line-number">55</pre><pre _ngcontent-gok-12="" class="line-number">56</pre><pre _ngcontent-gok-12="" class="line-number">57</pre><pre _ngcontent-gok-12="" class="line-number">58</pre><pre _ngcontent-gok-12="" class="line-number">59</pre><pre _ngcontent-gok-12="" class="line-number">60</pre><pre _ngcontent-gok-12="" class="line-number">61</pre><pre _ngcontent-gok-12="" class="line-number">62</pre><pre _ngcontent-gok-12="" class="line-number">63</pre><pre _ngcontent-gok-12="" class="line-number">64</pre><pre _ngcontent-gok-12="" class="line-number">65</pre><pre _ngcontent-gok-12="" class="line-number">66</pre>
            </div>
            <div _ngcontent-gok-12="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-context" className="line-context">      alert(<span class="hljs-string">'Please log in to change this party'</span>);</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">    }</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  invite(user: Meteor.User) {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">this</span>.call(<span class="hljs-string">'invite'</span>, <span class="hljs-keyword">this</span>.party._id, user._id, (error) =&gt; {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">if</span> (error) {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        alert(<span class="hljs-string">`Failed to invite due to <span class="hljs-subst">${error}</span>`</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        <span class="hljs-keyword">return</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      alert(<span class="hljs-string">'User successfully invited.'</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    });</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">}</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<h3>Updating Invited Users Reactively</h3>

<p>One more thing before we are done with the party owner's invitation
logic. We, of course, would like to make this list of users
change reactively, i.e. each user disappears from the list
when the invitation has been sent successfully.</p>

<p>It's worth mentioning that each party should change appropriately
when we invite a user — the party <code ngNonBindable="">invited</code> array should update
in the local Mongo storage. If we wrap the line where
we get the new party with the <code ngNonBindable="">autorun</code> method, this code should
re-run reactively:</p>

<p><diffbox step="14.6" tutorial="angular2-meteor-socially" _nghost-gok-12=""><div _ngcontent-gok-12="" class="diffbox">
    <div _ngcontent-gok-12="" class="title-panel">
        <span _ngcontent-gok-12="" class="step-number">14.6</span> <span _ngcontent-gok-12="" class="commit-summary">Get the party reactively</span>
        <a _ngcontent-gok-12="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/cf8d280887ed5b10859ba00aa2942856e2344da6">client/imports/party-details/party-details.ts</a>
    </div>
    <div _ngcontent-gok-12="" class="code-container">
        <div _ngcontent-gok-12="" class="scroll-container">
            <div _ngcontent-gok-12="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-number">30</pre><pre _ngcontent-gok-12="" class="line-number">31</pre><pre _ngcontent-gok-12="" class="line-number">32</pre><pre _ngcontent-gok-12="" class="line-number">33</pre><pre _ngcontent-gok-12="" class="line-number">34</pre><pre _ngcontent-gok-12="" class="line-number">35</pre><pre _ngcontent-gok-12="" class="line-number">36</pre><pre _ngcontent-gok-12="" class="line-number">37</pre><pre _ngcontent-gok-12="" class="line-number">38</pre><pre _ngcontent-gok-12="" class="line-number">39</pre><pre _ngcontent-gok-12="" class="line-number">40</pre><pre _ngcontent-gok-12="" class="line-number">41</pre>
            </div>
            <div _ngcontent-gok-12="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-context" className="line-context">      <span class="hljs-keyword">this</span>.partyId = params[<span class="hljs-string">'partyId'</span>];</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"> </pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">      <span class="hljs-keyword">this</span>.subscribe(<span class="hljs-string">'party'</span>, <span class="hljs-keyword">this</span>.partyId, () =&gt; {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        <span class="hljs-keyword">this</span>.autorun(() =&gt; {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">          <span class="hljs-keyword">this</span>.party = Parties.findOne(<span class="hljs-keyword">this</span>.partyId);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        }, <span class="hljs-literal">true</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      });</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">this</span>.subscribe(<span class="hljs-string">'uninvited'</span>, <span class="hljs-keyword">this</span>.partyId, () =&gt; {</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">        <span class="hljs-keyword">this</span>.users = Meteor.users.find({_id: {$ne: Meteor.userId()}});</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">      }, <span class="hljs-literal">true</span>);</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">    });</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>Now its time to update our users list.
We'll move the line that gets the users list into a
separate method, provided with the list of IDs of already invited users;
and call it whenever we need: right in the above <code ngNonBindable="">autorun</code> method after the party assignment and in the subscription, like that:</p>

<p><diffbox step="14.7" tutorial="angular2-meteor-socially" _nghost-gok-12=""><div _ngcontent-gok-12="" class="diffbox">
    <div _ngcontent-gok-12="" class="title-panel">
        <span _ngcontent-gok-12="" class="step-number">14.7</span> <span _ngcontent-gok-12="" class="commit-summary">Update the users list reactively</span>
        <a _ngcontent-gok-12="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/a63e6b01914eebc298dce419a2b5d4908105265a">client/imports/party-details/party-details.ts</a>
    </div>
    <div _ngcontent-gok-12="" class="code-container">
        <div _ngcontent-gok-12="" class="scroll-container">
            <div _ngcontent-gok-12="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-number">32</pre><pre _ngcontent-gok-12="" class="line-number">33</pre><pre _ngcontent-gok-12="" class="line-number">34</pre><pre _ngcontent-gok-12="" class="line-number">35</pre><pre _ngcontent-gok-12="" class="line-number">36</pre><pre _ngcontent-gok-12="" class="line-number">37</pre><pre _ngcontent-gok-12="" class="line-number">38</pre><pre _ngcontent-gok-12="" class="line-number">39</pre><pre _ngcontent-gok-12="" class="line-number">40</pre><pre _ngcontent-gok-12="" class="line-number">41</pre><pre _ngcontent-gok-12="" class="line-number">42</pre><pre _ngcontent-gok-12="" class="line-number">43</pre><pre _ngcontent-gok-12="" class="line-number">44</pre><pre _ngcontent-gok-12="" class="line-number">45</pre><pre _ngcontent-gok-12="" class="line-number">46</pre><pre _ngcontent-gok-12="" class="line-number">47</pre><pre _ngcontent-gok-12="" class="line-number">48</pre><pre _ngcontent-gok-12="" class="line-number">49</pre><pre _ngcontent-gok-12="" class="line-number">50</pre><pre _ngcontent-gok-12="" class="line-number">51</pre><pre _ngcontent-gok-12="" class="line-number">52</pre><pre _ngcontent-gok-12="" class="line-number">53</pre><pre _ngcontent-gok-12="" class="line-number">54</pre><pre _ngcontent-gok-12="" class="line-number">55</pre><pre _ngcontent-gok-12="" class="line-number">56</pre><pre _ngcontent-gok-12="" class="line-number">57</pre><pre _ngcontent-gok-12="" class="line-number">58</pre>
            </div>
            <div _ngcontent-gok-12="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-context" className="line-context">      <span class="hljs-keyword">this</span>.subscribe(<span class="hljs-string">'party'</span>, <span class="hljs-keyword">this</span>.partyId, () =&gt; {</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">        <span class="hljs-keyword">this</span>.autorun(() =&gt; {</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">          <span class="hljs-keyword">this</span>.party = Parties.findOne(<span class="hljs-keyword">this</span>.partyId);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">          <span class="hljs-keyword">this</span>.getUsers(<span class="hljs-keyword">this</span>.party);</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">        }, <span class="hljs-literal">true</span>);</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">      });</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"> </pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">      <span class="hljs-keyword">this</span>.subscribe(<span class="hljs-string">'uninvited'</span>, <span class="hljs-keyword">this</span>.partyId, () =&gt; {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        <span class="hljs-keyword">this</span>.getUsers(<span class="hljs-keyword">this</span>.party);</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">      }, <span class="hljs-literal">true</span>);</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">    });</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  }</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  getUsers(party: Party) {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">if</span> (party) {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">this</span>.users = Meteor.users.find({</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        _id: {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">          $nin: party.invited || [],</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">          $ne: Meteor.userId()</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      });</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  saveParty(party) {</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">    <span class="hljs-keyword">if</span> (Meteor.userId()) {</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">      Parties.update(party._id, {</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>Here comes test time. Let's add a couple of new users.
Then login as an old user and add a new party.
Go to the party: you should see a list of all users including
newly created ones. Invite several of them — each item in the list
should disappear after a successful invitation.</p>

<p>What's important to notice here is that each user item in the users list
disappears right after the click, even before the message about
the invitation was successfully sent. That's the latency compensation at work!</p>

<h1>User Reply</h1>

<p>Here we are going to implement the user reply to the party invitation request.</p>

<p>First of all, let's make parties list a bit more secure,
which means two things: showing private parties to those who have been invited
or to owners, and elaborate routing activation defense for the party details view:</p>

<p><diffbox step="14.8" tutorial="angular2-meteor-socially" _nghost-gok-12=""><div _ngcontent-gok-12="" class="diffbox">
    <div _ngcontent-gok-12="" class="title-panel">
        <span _ngcontent-gok-12="" class="step-number">14.8</span> <span _ngcontent-gok-12="" class="commit-summary">Show private parties to the invited and owners only</span>
        <a _ngcontent-gok-12="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/ebbcf1c400124dbbd1defb898c9fa4630a77551c">server/parties.ts</a>
    </div>
    <div _ngcontent-gok-12="" class="code-container">
        <div _ngcontent-gok-12="" class="scroll-container">
            <div _ngcontent-gok-12="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-number">5</pre><pre _ngcontent-gok-12="" class="line-number">6</pre><pre _ngcontent-gok-12="" class="line-number">7</pre><pre _ngcontent-gok-12="" class="line-number">8</pre><pre _ngcontent-gok-12="" class="line-number">9</pre><pre _ngcontent-gok-12="" class="line-number">10</pre><pre _ngcontent-gok-12="" class="line-number">11</pre><pre _ngcontent-gok-12="" class="line-number">12</pre><pre _ngcontent-gok-12="" class="line-number">13</pre><pre _ngcontent-gok-12="" class="line-number">14</pre><pre _ngcontent-gok-12="" class="line-number">15</pre><pre _ngcontent-gok-12="" class="line-number">16</pre><pre _ngcontent-gok-12="" class="line-number">17</pre><pre _ngcontent-gok-12="" class="line-number">18</pre><pre _ngcontent-gok-12="" class="line-number">19</pre><pre _ngcontent-gok-12="" class="line-number">20</pre><pre _ngcontent-gok-12="" class="line-number">21</pre>
            </div>
            <div _ngcontent-gok-12="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildQuery</span>(<span class="hljs-params">partyId: <span class="hljs-built_in">string</span>, location: <span class="hljs-built_in">string</span></span>): <span class="hljs-title">Object</span> </span>{</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  <span class="hljs-keyword">var</span> isAvailable = {</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">    $or: [</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      { <span class="hljs-string">'public'</span>: <span class="hljs-literal">true</span> },</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">      {</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">        $and: [</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">          { owner: <span class="hljs-keyword">this</span>.userId },</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">          { owner: { $exists: <span class="hljs-literal">true</span> } }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        ],</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      },</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        $and: [</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">          { invited: <span class="hljs-keyword">this</span>.userId },</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">          { invited: { $exists: <span class="hljs-literal">true</span> } }</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">        ]</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">      }</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">    ]</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>The next thing is a party invitee response to the invitation itself. Here, as usual,
we'll need to update the server side and UI. For the server,
let's add a new <code ngNonBindable="">reply</code> Meteor Method:</p>

<p><diffbox step="14.9" tutorial="angular2-meteor-socially" _nghost-gok-12=""><div _ngcontent-gok-12="" class="diffbox">
    <div _ngcontent-gok-12="" class="title-panel">
        <span _ngcontent-gok-12="" class="step-number">14.9</span> <span _ngcontent-gok-12="" class="commit-summary">Add a "reply" method</span>
        <a _ngcontent-gok-12="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/5fa828ebfd05106db0a5c0a18e902a07042fc6f0">collections/methods.ts</a>
    </div>
    <div _ngcontent-gok-12="" class="code-container">
        <div _ngcontent-gok-12="" class="scroll-container">
            <div _ngcontent-gok-12="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-number">43</pre><pre _ngcontent-gok-12="" class="line-number">44</pre><pre _ngcontent-gok-12="" class="line-number">45</pre><pre _ngcontent-gok-12="" class="line-number">46</pre><pre _ngcontent-gok-12="" class="line-number">47</pre><pre _ngcontent-gok-12="" class="line-number">48</pre><pre _ngcontent-gok-12="" class="line-number">49</pre><pre _ngcontent-gok-12="" class="line-number">50</pre><pre _ngcontent-gok-12="" class="line-number">51</pre><pre _ngcontent-gok-12="" class="line-number">52</pre><pre _ngcontent-gok-12="" class="line-number">53</pre><pre _ngcontent-gok-12="" class="line-number">54</pre><pre _ngcontent-gok-12="" class="line-number">55</pre><pre _ngcontent-gok-12="" class="line-number">56</pre><pre _ngcontent-gok-12="" class="line-number">57</pre><pre _ngcontent-gok-12="" class="line-number">58</pre><pre _ngcontent-gok-12="" class="line-number">59</pre><pre _ngcontent-gok-12="" class="line-number">60</pre><pre _ngcontent-gok-12="" class="line-number">61</pre><pre _ngcontent-gok-12="" class="line-number">62</pre><pre _ngcontent-gok-12="" class="line-number">63</pre><pre _ngcontent-gok-12="" class="line-number">64</pre><pre _ngcontent-gok-12="" class="line-number">65</pre><pre _ngcontent-gok-12="" class="line-number">66</pre><pre _ngcontent-gok-12="" class="line-number">67</pre><pre _ngcontent-gok-12="" class="line-number">68</pre><pre _ngcontent-gok-12="" class="line-number">69</pre><pre _ngcontent-gok-12="" class="line-number">70</pre><pre _ngcontent-gok-12="" class="line-number">71</pre><pre _ngcontent-gok-12="" class="line-number">72</pre><pre _ngcontent-gok-12="" class="line-number">73</pre><pre _ngcontent-gok-12="" class="line-number">74</pre><pre _ngcontent-gok-12="" class="line-number">75</pre><pre _ngcontent-gok-12="" class="line-number">76</pre><pre _ngcontent-gok-12="" class="line-number">77</pre><pre _ngcontent-gok-12="" class="line-number">78</pre><pre _ngcontent-gok-12="" class="line-number">79</pre><pre _ngcontent-gok-12="" class="line-number">80</pre><pre _ngcontent-gok-12="" class="line-number">81</pre><pre _ngcontent-gok-12="" class="line-number">82</pre><pre _ngcontent-gok-12="" class="line-number">83</pre><pre _ngcontent-gok-12="" class="line-number">84</pre><pre _ngcontent-gok-12="" class="line-number">85</pre><pre _ngcontent-gok-12="" class="line-number">86</pre><pre _ngcontent-gok-12="" class="line-number">87</pre><pre _ngcontent-gok-12="" class="line-number">88</pre><pre _ngcontent-gok-12="" class="line-number">89</pre><pre _ngcontent-gok-12="" class="line-number">90</pre><pre _ngcontent-gok-12="" class="line-number">91</pre><pre _ngcontent-gok-12="" class="line-number">92</pre>
            </div>
            <div _ngcontent-gok-12="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-context" className="line-context">        });</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">      }</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">    }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  },</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  reply: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">partyId: <span class="hljs-built_in">string</span>, rsvp: <span class="hljs-built_in">string</span></span>) </span>{</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    check(partyId, <span class="hljs-built_in">String</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    check(rsvp, <span class="hljs-built_in">String</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.userId)</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Meteor.Error(<span class="hljs-string">'403'</span>, <span class="hljs-string">'You must be logged-in to reply'</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">if</span> ([<span class="hljs-string">'yes'</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'maybe'</span>].indexOf(rsvp) === <span class="hljs-number">-1</span>)</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Meteor.Error(<span class="hljs-string">'400'</span>, <span class="hljs-string">'Invalid RSVP'</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">let</span> party = Parties.findOne({ _id: partyId });</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">if</span> (!party)</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Meteor.Error(<span class="hljs-string">'404'</span>, <span class="hljs-string">'No such party'</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">if</span> (party.owner === <span class="hljs-keyword">this</span>.userId)</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Meteor.Error(<span class="hljs-string">'500'</span>, <span class="hljs-string">'You are the owner!'</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">if</span> (!party.public &amp;&amp; (!party.invited || party.invited.indexOf(<span class="hljs-keyword">this</span>.userId) == <span class="hljs-number">-1</span>))</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Meteor.Error(<span class="hljs-string">'403'</span>, <span class="hljs-string">'No such party'</span>); <span class="hljs-comment">// its private, but let's not tell this to the user</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">let</span> rsvpIndex = party.rsvps ? party.rsvps.findIndex((rsvp) =&gt; rsvp.userId === <span class="hljs-keyword">this</span>.userId) : <span class="hljs-number">-1</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">if</span> (rsvpIndex !== <span class="hljs-number">-1</span>) {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-comment">// update existing rsvp entry</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">if</span> (Meteor.isServer) {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        <span class="hljs-comment">// update the appropriate rsvp entry with $</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        Parties.update(</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">          { _id: partyId, <span class="hljs-string">'rsvps.userId'</span>: <span class="hljs-keyword">this</span>.userId },</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">          { $<span class="hljs-keyword">set</span>: { <span class="hljs-string">'rsvps.$.response'</span>: rsvp } });</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      } <span class="hljs-keyword">else</span> {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        <span class="hljs-comment">// minimongo doesn't yet support $ in modifier. as a temporary</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        <span class="hljs-comment">// workaround, make a modifier that uses an index. this is</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        <span class="hljs-comment">// safe on the client since there's only one thread.</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        <span class="hljs-keyword">let</span> modifier = { $<span class="hljs-keyword">set</span>: {} };</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        modifier.$<span class="hljs-keyword">set</span>[<span class="hljs-string">'rsvps.'</span> + rsvpIndex + <span class="hljs-string">'.response'</span>] = rsvp;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        Parties.update(partyId, modifier);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    } <span class="hljs-keyword">else</span> {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-comment">// add new rsvp entry</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      Parties.update(partyId,</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        { $push: { rsvps: { userId: <span class="hljs-keyword">this</span>.userId, response: rsvp } } });</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    }</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  }</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">});</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>As you can see, a new property, called "rsvp", was added
above to collect user responses of this particular party.
One more thing. Let's update the party declaration file to
make TypeScript resolve and compile with no warnings:</p>

<p><diffbox step="14.10" tutorial="angular2-meteor-socially" _nghost-gok-12=""><div _ngcontent-gok-12="" class="diffbox">
    <div _ngcontent-gok-12="" class="title-panel">
        <span _ngcontent-gok-12="" class="step-number">14.10</span> <span _ngcontent-gok-12="" class="commit-summary">Update the party typings</span>
        <a _ngcontent-gok-12="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/9b4547da59e9789031cbcaace608076cef09bf8d">typings/party.d.ts</a>
    </div>
    <div _ngcontent-gok-12="" class="code-container">
        <div _ngcontent-gok-12="" class="scroll-container">
            <div _ngcontent-gok-12="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-number">6</pre><pre _ngcontent-gok-12="" class="line-number">7</pre><pre _ngcontent-gok-12="" class="line-number">8</pre><pre _ngcontent-gok-12="" class="line-number">9</pre><pre _ngcontent-gok-12="" class="line-number">10</pre><pre _ngcontent-gok-12="" class="line-number">11</pre><pre _ngcontent-gok-12="" class="line-number">12</pre><pre _ngcontent-gok-12="" class="line-number">13</pre><pre _ngcontent-gok-12="" class="line-number">14</pre><pre _ngcontent-gok-12="" class="line-number">15</pre>
            </div>
            <div _ngcontent-gok-12="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-context" className="line-context">  owner?: <span class="hljs-built_in">string</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  <span class="hljs-keyword">public</span>: <span class="hljs-built_in">boolean</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  invited?: <span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">string</span>&gt;;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  rsvps?: <span class="hljs-built_in">Array</span>&lt;RSVP&gt;;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">}</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"><span class="hljs-keyword">interface</span> RSVP {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  userId: <span class="hljs-built_in">string</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  response: <span class="hljs-built_in">string</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">}</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>For the UI, let's add three new buttons onto the party details view.
These will be "yes", "no", "maybe" buttons and users responses accordingly:</p>

<p><diffbox step="14.11" tutorial="angular2-meteor-socially" _nghost-gok-12=""><div _ngcontent-gok-12="" class="diffbox">
    <div _ngcontent-gok-12="" class="title-panel">
        <span _ngcontent-gok-12="" class="step-number">14.11</span> <span _ngcontent-gok-12="" class="commit-summary">Update PartyDetails view with the three response buttons</span>
        <a _ngcontent-gok-12="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/48fa9991b8ee14d0d4def7d738d337ec066f7951">client/imports/party-details/party-details.html</a>
    </div>
    <div _ngcontent-gok-12="" class="code-container">
        <div _ngcontent-gok-12="" class="scroll-container">
            <div _ngcontent-gok-12="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-number">19</pre><pre _ngcontent-gok-12="" class="line-number">20</pre><pre _ngcontent-gok-12="" class="line-number">21</pre><pre _ngcontent-gok-12="" class="line-number">22</pre><pre _ngcontent-gok-12="" class="line-number">23</pre><pre _ngcontent-gok-12="" class="line-number">24</pre><pre _ngcontent-gok-12="" class="line-number">25</pre><pre _ngcontent-gok-12="" class="line-number">26</pre><pre _ngcontent-gok-12="" class="line-number">27</pre><pre _ngcontent-gok-12="" class="line-number">28</pre>
            </div>
            <div _ngcontent-gok-12="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-context" className="line-context">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"invite(user)"</span>&gt;</span>Invite<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Reply to the invitation<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"I'm going!"</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"reply('yes')"</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Maybe"</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"reply('maybe')"</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"No"</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"reply('no')"</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>Then, handle click events in the PartyDetails component:</p>

<p><diffbox step="14.12" tutorial="angular2-meteor-socially" _nghost-gok-12=""><div _ngcontent-gok-12="" class="diffbox">
    <div _ngcontent-gok-12="" class="title-panel">
        <span _ngcontent-gok-12="" class="step-number">14.12</span> <span _ngcontent-gok-12="" class="commit-summary">Handle reply events in the PartyDetails component</span>
        <a _ngcontent-gok-12="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/70e08d59eca976180d2dd0ff34e290a52137476a">client/imports/party-details/party-details.ts</a>
    </div>
    <div _ngcontent-gok-12="" class="code-container">
        <div _ngcontent-gok-12="" class="scroll-container">
            <div _ngcontent-gok-12="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-number">77</pre><pre _ngcontent-gok-12="" class="line-number">78</pre><pre _ngcontent-gok-12="" class="line-number">79</pre><pre _ngcontent-gok-12="" class="line-number">80</pre><pre _ngcontent-gok-12="" class="line-number">81</pre><pre _ngcontent-gok-12="" class="line-number">82</pre><pre _ngcontent-gok-12="" class="line-number">83</pre><pre _ngcontent-gok-12="" class="line-number">84</pre><pre _ngcontent-gok-12="" class="line-number">85</pre><pre _ngcontent-gok-12="" class="line-number">86</pre><pre _ngcontent-gok-12="" class="line-number">87</pre><pre _ngcontent-gok-12="" class="line-number">88</pre><pre _ngcontent-gok-12="" class="line-number">89</pre><pre _ngcontent-gok-12="" class="line-number">90</pre><pre _ngcontent-gok-12="" class="line-number">91</pre>
            </div>
            <div _ngcontent-gok-12="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-context" className="line-context">      alert(<span class="hljs-string">'User successfully invited.'</span>);</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">    });</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  reply(rsvp: <span class="hljs-built_in">string</span>) {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">this</span>.call(<span class="hljs-string">'reply'</span>, <span class="hljs-keyword">this</span>.party._id, rsvp, (error) =&gt; {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">if</span> (error) {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        alert(<span class="hljs-string">`Failed to reply due to <span class="hljs-subst">${error}</span>`</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">else</span> {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        alert(<span class="hljs-string">'You successfully replied.'</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    });</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  }</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">}</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<h3>Rsvp Pipe</h3>

<p>Last, but not the least, let's show statistics of the invitation responses for the party owner.
Let's imagine that any party owner
would like to know the total number of those who declined, accepted, or remain tentative.
This is a perfect use case to add a new stateful pipe, which takes as
an input a party and a one of the RSVP responses, and calculates the total number of responses
associated with this, provided as a parameter we'll call "response".</p>

<p>Add a new pipe to the <code ngNonBindable="">lib/pipes.ts</code> as follows:</p>

<p><diffbox step="14.13" tutorial="angular2-meteor-socially" _nghost-gok-12=""><div _ngcontent-gok-12="" class="diffbox">
    <div _ngcontent-gok-12="" class="title-panel">
        <span _ngcontent-gok-12="" class="step-number">14.13</span> <span _ngcontent-gok-12="" class="commit-summary">Add a new response counting pipe</span>
        <a _ngcontent-gok-12="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/51c8c50200ec6ba297fdda8c1446b1cb2b66403b">client/imports/pipes/pipes.ts</a>
    </div>
    <div _ngcontent-gok-12="" class="code-container">
        <div _ngcontent-gok-12="" class="scroll-container">
            <div _ngcontent-gok-12="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-number">1</pre><pre _ngcontent-gok-12="" class="line-number">2</pre><pre _ngcontent-gok-12="" class="line-number">3</pre><pre _ngcontent-gok-12="" class="line-number">4</pre><pre _ngcontent-gok-12="" class="line-number">5</pre><pre _ngcontent-gok-12="" class="line-number">6</pre><pre _ngcontent-gok-12="" class="line-number">7</pre><pre _ngcontent-gok-12="" class="line-number">8</pre><pre _ngcontent-gok-12="" class="line-number"> </pre><pre _ngcontent-gok-12="" class="line-number">23</pre><pre _ngcontent-gok-12="" class="line-number">24</pre><pre _ngcontent-gok-12="" class="line-number">25</pre><pre _ngcontent-gok-12="" class="line-number">26</pre><pre _ngcontent-gok-12="" class="line-number">27</pre><pre _ngcontent-gok-12="" class="line-number">28</pre><pre _ngcontent-gok-12="" class="line-number">29</pre><pre _ngcontent-gok-12="" class="line-number">30</pre><pre _ngcontent-gok-12="" class="line-number">31</pre><pre _ngcontent-gok-12="" class="line-number">32</pre><pre _ngcontent-gok-12="" class="line-number">33</pre><pre _ngcontent-gok-12="" class="line-number">34</pre><pre _ngcontent-gok-12="" class="line-number">35</pre><pre _ngcontent-gok-12="" class="line-number">36</pre><pre _ngcontent-gok-12="" class="line-number">37</pre><pre _ngcontent-gok-12="" class="line-number">38</pre><pre _ngcontent-gok-12="" class="line-number">39</pre><pre _ngcontent-gok-12="" class="line-number">40</pre><pre _ngcontent-gok-12="" class="line-number">41</pre><pre _ngcontent-gok-12="" class="line-number">42</pre><pre _ngcontent-gok-12="" class="line-number">43</pre><pre _ngcontent-gok-12="" class="line-number">44</pre><pre _ngcontent-gok-12="" class="line-number">45</pre><pre _ngcontent-gok-12="" class="line-number">46</pre><pre _ngcontent-gok-12="" class="line-number">47</pre><pre _ngcontent-gok-12="" class="line-number">48</pre><pre _ngcontent-gok-12="" class="line-number">49</pre><pre _ngcontent-gok-12="" class="line-number">50</pre><pre _ngcontent-gok-12="" class="line-number">51</pre><pre _ngcontent-gok-12="" class="line-number">52</pre><pre _ngcontent-gok-12="" class="line-number">53</pre><pre _ngcontent-gok-12="" class="line-number">54</pre><pre _ngcontent-gok-12="" class="line-number">55</pre>
            </div>
            <div _ngcontent-gok-12="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> <span class="hljs-string">'reflect-metadata'</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> { Pipe } from <span class="hljs-string">'@angular/core'</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> { Meteor } from <span class="hljs-string">'meteor/meteor'</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"><span class="hljs-keyword">import</span> { Parties } from <span class="hljs-string">'../../../collections/parties.ts'</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"><span class="hljs-keyword">import</span> { MeteorComponent } from <span class="hljs-string">'angular2-meteor'</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"> </pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">@Pipe({</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  name: <span class="hljs-string">'displayName'</span></pre><pre _ngcontent-gok-12="" class="" className=""><span class="hljs-comment">...some lines skipped...</span></pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"> </pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">}</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">@Pipe({</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  name: <span class="hljs-string">'rsvp'</span>,</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  pure: <span class="hljs-literal">false</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">})</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> RsvpPipe extends MeteorComponent {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  init: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  total: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  transform(party: Party, <span class="hljs-keyword">type</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">number</span> {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">type</span>) {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.init) {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">this</span>.autorun(() =&gt; {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        <span class="hljs-keyword">const</span> found = Parties.findOne(party._id);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        <span class="hljs-keyword">if</span> (found) {</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">          <span class="hljs-keyword">this</span>.total = found.rsvps ?</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">            found.rsvps.filter(rsvp =&gt; rsvp.response === <span class="hljs-keyword">type</span>).length : <span class="hljs-number">0</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      }, <span class="hljs-literal">true</span>);</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-keyword">this</span>.init = <span class="hljs-literal">true</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"> </pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.total;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  }</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">}</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>Let's take a look at our 'rsvp' pipe closely. The pipe extends <code ngNonBindable="">MeteorComponent</code> and
uses its <code ngNonBindable="">autorun</code> method to watch for the party's updates.
Whenever the party's <code ngNonBindable="">rsvp</code> array changes, new numbers will be
displayed as required. That's the reason why this pipe is considered stateful:
it not only transforms one value to another, but also subscribes to the updates.</p>

<p>You may have noticed as well, that the new property <code ngNonBindable="">pure</code> is set to true
in the <code ngNonBindable="">@Pipe</code> decorator, which tells Angular 2's check detection
system to check this pipe on changes as well, i.e., in the same way as any other
component.</p>

<p>It's also worth mentioning that the arguments of a Pipe implementation inside a template are passed to the <code ngNonBindable="">transform</code> method in the same form. Only difference is that the first argument of <code ngNonBindable="">transform</code> is a value to be transformed. In our case, passed only the RSVP response, hence, we are taking the first
value in the list.</p>

<p>An example:</p>

<p><code ngNonBindable="">js
// usage: text | subStr:20:50
@Pipe({name: 'subStr'})
class SubStrPipe {
  transform(text: string, starts: number, ends: number) {
    return text.substring(starts, ends);
  }
}
</code></p>

<p>Let's make use of this pipe in the <code ngNonBindable="">PartiesList</code> component:</p>

<p><diffbox step="14.14" tutorial="angular2-meteor-socially" _nghost-gok-12=""><div _ngcontent-gok-12="" class="diffbox">
    <div _ngcontent-gok-12="" class="title-panel">
        <span _ngcontent-gok-12="" class="step-number">14.14</span> <span _ngcontent-gok-12="" class="commit-summary">Display response statistics in the list</span>
        <a _ngcontent-gok-12="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/a2ae045e882fc8c74f0abc1d229e1edd611ccfa0">client/imports/parties-list/parties-list.html</a>
    </div>
    <div _ngcontent-gok-12="" class="code-container">
        <div _ngcontent-gok-12="" class="scroll-container">
            <div _ngcontent-gok-12="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-number">16</pre><pre _ngcontent-gok-12="" class="line-number">17</pre><pre _ngcontent-gok-12="" class="line-number">18</pre><pre _ngcontent-gok-12="" class="line-number">19</pre><pre _ngcontent-gok-12="" class="line-number">20</pre><pre _ngcontent-gok-12="" class="line-number">21</pre><pre _ngcontent-gok-12="" class="line-number">22</pre><pre _ngcontent-gok-12="" class="line-number">23</pre><pre _ngcontent-gok-12="" class="line-number">24</pre><pre _ngcontent-gok-12="" class="line-number">25</pre><pre _ngcontent-gok-12="" class="line-number">26</pre><pre _ngcontent-gok-12="" class="line-number">27</pre>
            </div>
            <div _ngcontent-gok-12="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-context" className="line-context">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{party.description}}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{party.location}}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"removeParty(party)"</span>&gt;</span>X<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        Who is coming:</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        Yes - {{party | rsvp:'yes'}}</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        Maybe - {{party | rsvp:'maybe'}}</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">        No - {{party | rsvp:'no'}}</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  <span class="hljs-tag">&lt;<span class="hljs-name">pagination-controls</span> (<span class="hljs-attr">change</span>)=<span class="hljs-string">"onPageChanged($event.page)"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">pagination-controls</span>&gt;</span></pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>And then in the component itself:</p>

<p><diffbox step="14.15" tutorial="angular2-meteor-socially" _nghost-gok-12=""><div _ngcontent-gok-12="" class="diffbox">
    <div _ngcontent-gok-12="" class="title-panel">
        <span _ngcontent-gok-12="" class="step-number">14.15</span> <span _ngcontent-gok-12="" class="commit-summary">Import the RsvpPipe pipe</span>
        <a _ngcontent-gok-12="" class="github-commit-link" target="_blank" href="http://github.com/Urigo/meteor-angular2.0-socially/commit/191220a8926f64ced0974f1f8c81b4f0936c4f95">client/imports/parties-list/parties-list.ts</a>
    </div>
    <div _ngcontent-gok-12="" class="code-container">
        <div _ngcontent-gok-12="" class="scroll-container">
            <div _ngcontent-gok-12="" class="line-numbers">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-number">8</pre><pre _ngcontent-gok-12="" class="line-number">9</pre><pre _ngcontent-gok-12="" class="line-number">10</pre><pre _ngcontent-gok-12="" class="line-number">11</pre><pre _ngcontent-gok-12="" class="line-number">12</pre><pre _ngcontent-gok-12="" class="line-number">13</pre><pre _ngcontent-gok-12="" class="line-number">14</pre><pre _ngcontent-gok-12="" class="line-number"> </pre><pre _ngcontent-gok-12="" class="line-number">17</pre><pre _ngcontent-gok-12="" class="line-number">18</pre><pre _ngcontent-gok-12="" class="line-number">19</pre><pre _ngcontent-gok-12="" class="line-number">20</pre><pre _ngcontent-gok-12="" class="line-number">21</pre><pre _ngcontent-gok-12="" class="line-number">22</pre><pre _ngcontent-gok-12="" class="line-number">23</pre>
            </div>
            <div _ngcontent-gok-12="" class="line-content">
                <!--template bindings={}--><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> { ReactiveVar } from <span class="hljs-string">'meteor/reactive-var'</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> { Counts } from <span class="hljs-string">'meteor/tmeasday:publish-counts'</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> { PaginationService, PaginatePipe, PaginationControlsCmp } from <span class="hljs-string">'angular2-pagination'</span>;</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added"><span class="hljs-keyword">import</span> { RsvpPipe } from <span class="hljs-string">'../pipes/pipes.ts'</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"> </pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-keyword">import</span> template from <span class="hljs-string">'./parties-list.html'</span>;</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"> </pre><pre _ngcontent-gok-12="" class="" className=""><span class="hljs-comment">...some lines skipped...</span></pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  viewProviders: [PaginationService],</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  template,</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  directives: [PartiesForm, ROUTER_DIRECTIVES, LoginButtons, PaginationControlsCmp],</pre><pre _ngcontent-gok-12="" class="line-added" className="line-added">  pipes: [PaginatePipe, RsvpPipe]</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">})</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> PartiesList extends MeteorComponent{</pre><pre _ngcontent-gok-12="" class="line-context" className="line-context">  parties: Mongo.Cursor&lt;Party&gt;;</pre>
            </div>
        </div>
    </div>
</div></diffbox></p>

<p>Now it's testing time! Check that an invited user is able to reply to an
invitation, and also verify that the party's statistics update properly and reactively.
Login as an existing user. Add a new party, go to the party and
invite some other users. Then, open a new browser window in the anonymous mode along with the current window,
and login as the invited user there. Go to the party details page, and reply, say, "no";
the party's statistics on the first page with the parties list should duly update.</p>

<h1>Challenge</h1>

<p>There is one important thing that we missed. Besides the party invitation
statistics, each user would like to know if she has already responded, in case she forgot,
to a particular invitation. This step's challenge will be to add this status
information onto the PartyDetails's view and make it update reactively.</p>

<blockquote><p>Hint: In order to make it reactive, you'll need to add one more handler into
the party <code ngNonBindable="">autorun</code>, like the <code ngNonBindable="">getUsers</code> method in the this step above.</p></blockquote>

<h1>Summary</h1>

<p>We've just finished the invitation feature in this step, having added bunch of new stuff.
Socially is looking much more mature with Meteor Methods on board. We can give ourselves
a big thumbs-up for that!</p>

<p>Though, some places in the app can certainly be improved. For example,
we still show some private information to all invited users, which should be designated only for the party owner.
We'll fix this in the next step.</p></tutorial-page-content>
    </div>
</div></tutorial></app>


</body></html>